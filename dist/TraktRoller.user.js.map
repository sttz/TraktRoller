{"version":3,"sources":["../node_modules/ste-core/dist/management.js","../node_modules/ste-core/dist/subscription.js","../node_modules/ste-core/dist/dispatching.js","../node_modules/ste-core/dist/index.js","../node_modules/ste-events/dist/events.js","../node_modules/ste-events/dist/index.js","../node_modules/ste-simple-events/dist/simple-events.js","../node_modules/ste-simple-events/dist/index.js","../node_modules/ste-signals/dist/signals.js","../node_modules/ste-signals/dist/index.js","../node_modules/strongly-typed-events/dist/index.js","TraktApi.ts","TraktScrobble.ts","../src/vnode.js","../src/options.js","../src/h.js","../src/util.js","../src/clone-element.js","../src/constants.js","../src/render-queue.js","../src/vdom/index.js","../src/dom/index.js","../src/vdom/diff.js","../src/vdom/component-recycler.js","../src/vdom/component.js","../src/component.js","../src/render.js","../src/preact.js","../node_modules/@emotion/sheet/dist/sheet.browser.esm.js","../node_modules/@emotion/cache/node_modules/@emotion/stylis/dist/stylis.browser.esm.js","../node_modules/@emotion/weak-memoize/dist/weak-memoize.browser.esm.js","../node_modules/@emotion/cache/dist/cache.browser.esm.js","../node_modules/@emotion/serialize/node_modules/@emotion/hash/dist/hash.browser.esm.js","../node_modules/@emotion/unitless/dist/unitless.browser.esm.js","../node_modules/@emotion/serialize/node_modules/@emotion/memoize/dist/memoize.browser.esm.js","../node_modules/@emotion/serialize/dist/serialize.browser.esm.js","../node_modules/@emotion/utils/dist/utils.browser.esm.js","../node_modules/create-emotion/dist/create-emotion.browser.esm.js","../node_modules/emotion/dist/emotion.esm.js","ui/TraktIcon.tsx","../node_modules/prop-types/lib/ReactPropTypesSecret.js","../node_modules/prop-types/factoryWithThrowingShims.js","../node_modules/prop-types/index.js","../node_modules/@emotion/memoize/dist/memoize.esm.js","../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.esm.js","../node_modules/create-emotion-styled/dist/index.esm.js","../node_modules/preact-emotion/dist/index.esm.js","ui/ConnectButton.tsx","ui/ScrobbleInfo.tsx","ui/Button.tsx","ui/ScrobbleHistory.tsx","ui/ScrobbleControl.tsx","ui/Popup.tsx","ui/StatusButton.tsx","TraktHistory.ts","TraktRoller.tsx","index.ts"],"names":["Object","defineProperty","exports","value","EventManagement","unsub","propagationStopped","prototype","stopPropagation","Subscription","handler","isOnce","isExecuted","execute","executeAsync","scope","args","fn","setTimeout","apply","management_1","require","subscription_1","DispatcherBase","_wrap","DispatcherWrapper","_subscriptions","Array","subscribe","_this","push","unsubscribe","sub","one","has","some","i","length","splice","_dispatch","_loop_1","ev","nargs","slice","call","this_1","cleanup","_i","_a","state_1","indexOf","asEvent","clear","EventListBase","_events","get","name","event","createDispatcher","remove","dispatcher","_subscribe","_unsubscribe","_one","_has","_clear","dispatching_1","__extends","extendStatics","setPrototypeOf","__proto__","d","b","p","hasOwnProperty","__","constructor","create","ste_core_1","EventDispatcher","_super","dispatch","sender","arguments","dispatchAsync","EventList","EventHandlingBase","enumerable","configurable","events_1","SimpleEventDispatcher","SimpleEventList","SimpleEventHandlingBase","simple_events_1","SignalDispatcher","SignalList","SignalHandlingBase","signals_1","ste_events_1","ste_simple_events_1","ste_signals_1","VNode","options","stack","EMPTY_CHILDREN","h","nodeName","attributes","children","lastSimple","child","simple","pop","undefined","String","key","vnode","extend","obj","props","applyRef","ref","current","defer","Promise","resolve","then","bind","cloneElement","NO_RENDER","SYNC_RENDER","FORCE_RENDER","ASYNC_RENDER","IS_NON_DIMENSIONAL","items","isSameNodeType","node","hydrating","_componentConstructor","isNamedNode","normalizedNodeName","defaultProps","document","createElementNS","removeNode","parentNode","removeChild","setAccessor","old","style","innerHTML","__html","useCapture","toLowerCase","_listeners","ns","eventProxy","mounts","diffLevel","flushMounts","c","shift","parent","ATTR_KEY","ret","componentRoot","out","prevSvgMode","buildComponentFromVNode","vnodeName","dom","firstChild","appendChild","vchildren","nodeValue","context","mountAll","dangerouslySetInnerHTML","originalChildren","keyed","min","len","childrenLen","vlen","j","f","vchild","keyedLen","component","unmountOnly","next","previousSibling","diffAttributes","attrs","recyclerComponents","createComponent","Ctor","nextBase","doRender","setComponentProps","_disable","componentWillReceiveProps","prevContext","renderMode","syncComponentUpdates","__ref","renderComponent","state","previousProps","previousState","isUpdate","base","initialBase","snapshot","rendered","inst","cbase","shouldComponentUpdate","prevProps","_dirty","render","getSnapshotBeforeUpdate","childComponent","toUnmount","childProps","getNodeProps","initialChildComponent","_parentComponent","_component","baseParent","replaceChild","componentRef","t","afterUpdate","_renderCallbacks","isChild","originalComponent","oldDom","isDirectOwner","isOwner","beforeUnmount","componentWillUnmount","callback","diff","merge","createRef","sheetForTag","tag","sheet","styleSheets","ownerNode","createStyleElement","createElement","setAttribute","nonce","createTextNode","StyleSheet","isSpeedy","speedy","tags","ctr","container","before","_proto","insert","rule","_tag","nextSibling","insertBefore","isImportRule","charCodeAt","insertRule","cssRules","e","console","warn","flush","forEach","stylis_min","W","M","a","m","v","n","q","g","x","K","k","u","l","r","I","B","J","y","F","G","C","replace","N","trim","charAt","substring","ca","O","A","X","H","D","z","join","da","ea","fa","w","L","P","Y","E","ha","Q","split","ia","Z","ja","ka","test","aa","ba","la","ma","R","na","oa","S","T","U","prefix","V","use","set","weakMemoize","func","cache","WeakMap","arg","delimiter","needle","toSheet","block","Sheet","ruleSheet","content","selectors","parents","line","column","depth","at","createCache","stylisOptions","stylis","Stylis","Error","inserted","head","nodes","querySelectorAll","attrib","getAttribute","id","_insert","stylisPlugins","selector","serialized","shouldCache","map","styles","commentStart","commentEnd","lastIndex","flag","unsafePseudoClasses","match","unsafePseudoClass","ignoreRegExp","RegExp","ignore","error","registered","murmurhash2_32_gc","str","toString","unitlessKeys","animationIterationCount","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","msGridRow","msGridRowSpan","msGridColumn","msGridColumnSpan","fontWeight","lineHeight","opacity","order","orphans","tabSize","widows","zIndex","zoom","WebkitLineClamp","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","memoize","hyphenateRegex","animationRegex","processStyleName","styleName","processStyleValue","p1","p2","cursor","unitless","contentValuePattern","contentValues","oldProcessStyleValue","msPattern","hyphenPattern","hyphenatedCache","processed","isCssVariable","char","toUpperCase","shouldWarnAboutInterpolatingClassNameFromCss","handleInterpolation","mergedProps","interpolation","couldBeSelectorInterpolation","__emotion_styles","anim","createStringFromObject","previousCursor","result","cached","string","isArray","_key","labelPattern","sourceMapPattern","serializeStyles","stringMode","strings","raw","sourceMap","identifierName","exec","isBrowser","getRegisteredStyles","registeredStyles","classNames","rawClassName","className","insertStyles","isStringTag","compat","maybeStyles","insertWithoutScoping","css","createEmotion","_len","keyframes","_len2","_key2","animation","injectGlobal","_len3","_key3","cx","_len4","_key4","classnames","hydrate","ids","cls","toAdd","_createEmotion","ReactIs","throwOnDirectAccess","module","isElement","reactPropsRegex","index","_inheritsLoose","subClass","superClass","channel","_contextTypes","contextTypes","PropTypes","object","setTheme","theme","setState","testPickPropsOnStringTag","isPropValid","testPickPropsOnComponent","testAlwaysTrue","pickAssign","testFn","target","source","warnedAboutExtractStatic","createEmotionStyled","emotion","view","_createStyled","createStyled","staticClassName","stableClassName","shouldForwardProp","label","__emotion_forwardProp","propName","isReal","__emotion_real","baseTag","__emotion_base","Styled","_view$Component","componentWillMount","classInterpolations","concat","innerRef","Component","displayName","withComponent","nextTag","nextOptions","Proxy","property","preact"],"mappings":"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","file":"TraktRoller.user.js","sourceRoot":"../source","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Allows the user to interact with the event.\r\n *\r\n * @class EventManagement\r\n * @implements {IEventManagement}\r\n */\r\nvar EventManagement = /** @class */ (function () {\r\n    function EventManagement(unsub) {\r\n        this.unsub = unsub;\r\n        this.propagationStopped = false;\r\n    }\r\n    EventManagement.prototype.stopPropagation = function () {\r\n        this.propagationStopped = true;\r\n    };\r\n    return EventManagement;\r\n}());\r\nexports.EventManagement = EventManagement;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n/**\r\n * Stores a handler. Manages execution meta data.\r\n * @class Subscription\r\n * @template TEventHandler\r\n */\r\nvar Subscription = /** @class */ (function () {\r\n    /**\r\n     * Creates an instance of Subscription.\r\n     *\r\n     * @param {TEventHandler} handler The handler for the subscription.\r\n     * @param {boolean} isOnce Indicates if the handler should only be executed once.\r\n     */\r\n    function Subscription(handler, isOnce) {\r\n        this.handler = handler;\r\n        this.isOnce = isOnce;\r\n        /**\r\n         * Indicates if the subscription has been executed before.\r\n         */\r\n        this.isExecuted = false;\r\n    }\r\n    /**\r\n     * Executes the handler.\r\n     *\r\n     * @param {boolean} executeAsync True if the even should be executed async.\r\n     * @param {*} scope The scope the scope of the event.\r\n     * @param {IArguments} args The arguments for the event.\r\n     */\r\n    Subscription.prototype.execute = function (executeAsync, scope, args) {\r\n        if (!this.isOnce || !this.isExecuted) {\r\n            this.isExecuted = true;\r\n            var fn = this.handler;\r\n            if (executeAsync) {\r\n                setTimeout(function () {\r\n                    fn.apply(scope, args);\r\n                }, 1);\r\n            }\r\n            else {\r\n                fn.apply(scope, args);\r\n            }\r\n        }\r\n    };\r\n    return Subscription;\r\n}());\r\nexports.Subscription = Subscription;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar management_1 = require(\"./management\");\r\nvar subscription_1 = require(\"./subscription\");\r\n/**\r\n * Base class for implementation of the dispatcher. It facilitates the subscribe\r\n * and unsubscribe methods based on generic handlers. The TEventType specifies\r\n * the type of event that should be exposed. Use the asEvent to expose the\r\n * dispatcher as event.\r\n */\r\nvar DispatcherBase = /** @class */ (function () {\r\n    function DispatcherBase() {\r\n        this._wrap = new DispatcherWrapper(this);\r\n        this._subscriptions = new Array();\r\n    }\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     */\r\n    DispatcherBase.prototype.subscribe = function (fn) {\r\n        var _this = this;\r\n        if (fn) {\r\n            this._subscriptions.push(new subscription_1.Subscription(fn, false));\r\n        }\r\n        return function () {\r\n            _this.unsubscribe(fn);\r\n        };\r\n    };\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     */\r\n    DispatcherBase.prototype.sub = function (fn) {\r\n        return this.subscribe(fn);\r\n    };\r\n    /**\r\n     * Subscribe once to the event with the specified name.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     */\r\n    DispatcherBase.prototype.one = function (fn) {\r\n        var _this = this;\r\n        if (fn) {\r\n            this._subscriptions.push(new subscription_1.Subscription(fn, true));\r\n        }\r\n        return function () {\r\n            _this.unsubscribe(fn);\r\n        };\r\n    };\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     * @param fn The event handler.\r\n     */\r\n    DispatcherBase.prototype.has = function (fn) {\r\n        if (!fn)\r\n            return false;\r\n        return this._subscriptions.some(function (sub) { return sub.handler == fn; });\r\n    };\r\n    /**\r\n     * Unsubscribes the handler from the dispatcher.\r\n     * @param fn The event handler.\r\n     */\r\n    DispatcherBase.prototype.unsubscribe = function (fn) {\r\n        if (!fn)\r\n            return;\r\n        for (var i = 0; i < this._subscriptions.length; i++) {\r\n            if (this._subscriptions[i].handler == fn) {\r\n                this._subscriptions.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Unsubscribes the handler from the dispatcher.\r\n     * @param fn The event handler.\r\n     */\r\n    DispatcherBase.prototype.unsub = function (fn) {\r\n        this.unsubscribe(fn);\r\n    };\r\n    /**\r\n     * Generic dispatch will dispatch the handlers with the given arguments.\r\n     *\r\n     * @protected\r\n     * @param {boolean} executeAsync True if the even should be executed async.\r\n     * @param {*} The scope the scope of the event. The scope becomes the \"this\" for handler.\r\n     * @param {IArguments} args The arguments for the event.\r\n     */\r\n    DispatcherBase.prototype._dispatch = function (executeAsync, scope, args) {\r\n        var _this = this;\r\n        var _loop_1 = function (sub) {\r\n            var ev = new management_1.EventManagement(function () { return _this.unsub(sub.handler); });\r\n            var nargs = Array.prototype.slice.call(args);\r\n            nargs.push(ev);\r\n            sub.execute(executeAsync, scope, nargs);\r\n            //cleanup subs that are no longer needed\r\n            this_1.cleanup(sub);\r\n            if (!executeAsync && ev.propagationStopped) {\r\n                return \"break\";\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        //execute on a copy because of bug #9\r\n        for (var _i = 0, _a = this._subscriptions.slice(); _i < _a.length; _i++) {\r\n            var sub = _a[_i];\r\n            var state_1 = _loop_1(sub);\r\n            if (state_1 === \"break\")\r\n                break;\r\n        }\r\n    };\r\n    /**\r\n     * Cleans up subs that ran and should run only once.\r\n     */\r\n    DispatcherBase.prototype.cleanup = function (sub) {\r\n        if (sub.isOnce && sub.isExecuted) {\r\n            var i = this._subscriptions.indexOf(sub);\r\n            if (i > -1) {\r\n                this._subscriptions.splice(i, 1);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    DispatcherBase.prototype.asEvent = function () {\r\n        return this._wrap;\r\n    };\r\n    /**\r\n     * Clears all the subscriptions.\r\n     */\r\n    DispatcherBase.prototype.clear = function () {\r\n        this._subscriptions.splice(0, this._subscriptions.length);\r\n    };\r\n    return DispatcherBase;\r\n}());\r\nexports.DispatcherBase = DispatcherBase;\r\n/**\r\n * Base class for event lists classes. Implements the get and remove.\r\n */\r\nvar EventListBase = /** @class */ (function () {\r\n    function EventListBase() {\r\n        this._events = {};\r\n    }\r\n    /**\r\n     * Gets the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    EventListBase.prototype.get = function (name) {\r\n        var event = this._events[name];\r\n        if (event) {\r\n            return event;\r\n        }\r\n        event = this.createDispatcher();\r\n        this._events[name] = event;\r\n        return event;\r\n    };\r\n    /**\r\n     * Removes the dispatcher associated with the name.\r\n     * @param name The name of the event.\r\n     */\r\n    EventListBase.prototype.remove = function (name) {\r\n        delete this._events[name];\r\n    };\r\n    return EventListBase;\r\n}());\r\nexports.EventListBase = EventListBase;\r\n/**\r\n * Hides the implementation of the event dispatcher. Will expose methods that\r\n * are relevent to the event.\r\n */\r\nvar DispatcherWrapper = /** @class */ (function () {\r\n    /**\r\n     * Creates a new EventDispatcherWrapper instance.\r\n     * @param dispatcher The dispatcher.\r\n     */\r\n    function DispatcherWrapper(dispatcher) {\r\n        this._subscribe = function (fn) { return dispatcher.subscribe(fn); };\r\n        this._unsubscribe = function (fn) { return dispatcher.unsubscribe(fn); };\r\n        this._one = function (fn) { return dispatcher.one(fn); };\r\n        this._has = function (fn) { return dispatcher.has(fn); };\r\n        this._clear = function () { return dispatcher.clear(); };\r\n    }\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     */\r\n    DispatcherWrapper.prototype.subscribe = function (fn) {\r\n        return this._subscribe(fn);\r\n    };\r\n    /**\r\n     * Subscribe to the event dispatcher.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     * @returns A function that unsubscribes the event handler from the event.\r\n     */\r\n    DispatcherWrapper.prototype.sub = function (fn) {\r\n        return this.subscribe(fn);\r\n    };\r\n    /**\r\n     * Unsubscribe from the event dispatcher.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     */\r\n    DispatcherWrapper.prototype.unsubscribe = function (fn) {\r\n        this._unsubscribe(fn);\r\n    };\r\n    /**\r\n     * Unsubscribe from the event dispatcher.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     */\r\n    DispatcherWrapper.prototype.unsub = function (fn) {\r\n        this.unsubscribe(fn);\r\n    };\r\n    /**\r\n     * Subscribe once to the event with the specified name.\r\n     * @param fn The event handler that is called when the event is dispatched.\r\n     */\r\n    DispatcherWrapper.prototype.one = function (fn) {\r\n        return this._one(fn);\r\n    };\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     * @param fn The event handler.\r\n     */\r\n    DispatcherWrapper.prototype.has = function (fn) {\r\n        return this._has(fn);\r\n    };\r\n    /**\r\n     * Clears all the subscriptions.\r\n     */\r\n    DispatcherWrapper.prototype.clear = function () {\r\n        this._clear();\r\n    };\r\n    return DispatcherWrapper;\r\n}());\r\nexports.DispatcherWrapper = DispatcherWrapper;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript - Core\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar dispatching_1 = require(\"./dispatching\");\r\nexports.DispatcherBase = dispatching_1.DispatcherBase;\r\nexports.DispatcherWrapper = dispatching_1.DispatcherWrapper;\r\nexports.EventListBase = dispatching_1.EventListBase;\r\nvar subscription_1 = require(\"./subscription\");\r\nexports.Subscription = subscription_1.Subscription;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ste_core_1 = require(\"ste-core\");\r\n/**\r\n * Dispatcher implementation for events. Can be used to subscribe, unsubscribe\r\n * or dispatch events. Use the ToEvent() method to expose the event.\r\n */\r\nvar EventDispatcher = /** @class */ (function (_super) {\r\n    __extends(EventDispatcher, _super);\r\n    /**\r\n     * Creates a new EventDispatcher instance.\r\n     */\r\n    function EventDispatcher() {\r\n        return _super.call(this) || this;\r\n    }\r\n    /**\r\n     * Dispatches the event.\r\n     * @param sender The sender.\r\n     * @param args The arguments object.\r\n     */\r\n    EventDispatcher.prototype.dispatch = function (sender, args) {\r\n        this._dispatch(false, this, arguments);\r\n    };\r\n    /**\r\n     * Dispatches the events thread.\r\n     * @param sender The sender.\r\n     * @param args The arguments object.\r\n     */\r\n    EventDispatcher.prototype.dispatchAsync = function (sender, args) {\r\n        this._dispatch(true, this, arguments);\r\n    };\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    EventDispatcher.prototype.asEvent = function () {\r\n        return _super.prototype.asEvent.call(this);\r\n    };\r\n    return EventDispatcher;\r\n}(ste_core_1.DispatcherBase));\r\nexports.EventDispatcher = EventDispatcher;\r\n/**\r\n * Storage class for multiple events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nvar EventList = /** @class */ (function (_super) {\r\n    __extends(EventList, _super);\r\n    /**\r\n     * Creates a new EventList instance.\r\n     */\r\n    function EventList() {\r\n        return _super.call(this) || this;\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    EventList.prototype.createDispatcher = function () {\r\n        return new EventDispatcher();\r\n    };\r\n    return EventList;\r\n}(ste_core_1.EventListBase));\r\nexports.EventList = EventList;\r\n/**\r\n * Extends objects with event handling capabilities.\r\n */\r\nvar EventHandlingBase = /** @class */ (function () {\r\n    function EventHandlingBase() {\r\n        this._events = new EventList();\r\n    }\r\n    Object.defineProperty(EventHandlingBase.prototype, \"events\", {\r\n        /**\r\n         * Gets the list with all the event dispatchers.\r\n         */\r\n        get: function () {\r\n            return this._events;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    EventHandlingBase.prototype.subscribe = function (name, fn) {\r\n        this._events.get(name).subscribe(fn);\r\n    };\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    EventHandlingBase.prototype.sub = function (name, fn) {\r\n        this.subscribe(name, fn);\r\n    };\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    EventHandlingBase.prototype.unsubscribe = function (name, fn) {\r\n        this._events.get(name).unsubscribe(fn);\r\n    };\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    EventHandlingBase.prototype.unsub = function (name, fn) {\r\n        this.unsubscribe(name, fn);\r\n    };\r\n    /**\r\n     * Subscribes to once the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    EventHandlingBase.prototype.one = function (name, fn) {\r\n        this._events.get(name).one(fn);\r\n    };\r\n    /**\r\n     * Subscribes to once the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    EventHandlingBase.prototype.has = function (name, fn) {\r\n        return this._events.get(name).has(fn);\r\n    };\r\n    return EventHandlingBase;\r\n}());\r\nexports.EventHandlingBase = EventHandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar events_1 = require(\"./events\");\r\nexports.EventDispatcher = events_1.EventDispatcher;\r\nexports.EventHandlingBase = events_1.EventHandlingBase;\r\nexports.EventList = events_1.EventList;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ste_core_1 = require(\"ste-core\");\r\n/**\r\n * The dispatcher handles the storage of subsciptions and facilitates\r\n * subscription, unsubscription and dispatching of a simple event\r\n */\r\nvar SimpleEventDispatcher = /** @class */ (function (_super) {\r\n    __extends(SimpleEventDispatcher, _super);\r\n    /**\r\n     * Creates a new SimpleEventDispatcher instance.\r\n     */\r\n    function SimpleEventDispatcher() {\r\n        return _super.call(this) || this;\r\n    }\r\n    /**\r\n     * Dispatches the event.\r\n     * @param args The arguments object.\r\n     */\r\n    SimpleEventDispatcher.prototype.dispatch = function (args) {\r\n        this._dispatch(false, this, arguments);\r\n    };\r\n    /**\r\n     * Dispatches the events thread.\r\n     * @param args The arguments object.\r\n     */\r\n    SimpleEventDispatcher.prototype.dispatchAsync = function (args) {\r\n        this._dispatch(true, this, arguments);\r\n    };\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    SimpleEventDispatcher.prototype.asEvent = function () {\r\n        return _super.prototype.asEvent.call(this);\r\n    };\r\n    return SimpleEventDispatcher;\r\n}(ste_core_1.DispatcherBase));\r\nexports.SimpleEventDispatcher = SimpleEventDispatcher;\r\n/**\r\n * Storage class for multiple simple events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nvar SimpleEventList = /** @class */ (function (_super) {\r\n    __extends(SimpleEventList, _super);\r\n    /**\r\n     * Creates a new SimpleEventList instance.\r\n     */\r\n    function SimpleEventList() {\r\n        return _super.call(this) || this;\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    SimpleEventList.prototype.createDispatcher = function () {\r\n        return new SimpleEventDispatcher();\r\n    };\r\n    return SimpleEventList;\r\n}(ste_core_1.EventListBase));\r\nexports.SimpleEventList = SimpleEventList;\r\n/**\r\n * Extends objects with simple event handling capabilities.\r\n */\r\nvar SimpleEventHandlingBase = /** @class */ (function () {\r\n    function SimpleEventHandlingBase() {\r\n        this._events = new SimpleEventList();\r\n    }\r\n    Object.defineProperty(SimpleEventHandlingBase.prototype, \"events\", {\r\n        get: function () {\r\n            return this._events;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SimpleEventHandlingBase.prototype.subscribe = function (name, fn) {\r\n        this._events.get(name).subscribe(fn);\r\n    };\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SimpleEventHandlingBase.prototype.sub = function (name, fn) {\r\n        this.subscribe(name, fn);\r\n    };\r\n    /**\r\n     * Subscribes once to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SimpleEventHandlingBase.prototype.one = function (name, fn) {\r\n        this._events.get(name).one(fn);\r\n    };\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SimpleEventHandlingBase.prototype.has = function (name, fn) {\r\n        return this._events.get(name).has(fn);\r\n    };\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SimpleEventHandlingBase.prototype.unsubscribe = function (name, fn) {\r\n        this._events.get(name).unsubscribe(fn);\r\n    };\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SimpleEventHandlingBase.prototype.unsub = function (name, fn) {\r\n        this.unsubscribe(name, fn);\r\n    };\r\n    return SimpleEventHandlingBase;\r\n}());\r\nexports.SimpleEventHandlingBase = SimpleEventHandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar simple_events_1 = require(\"./simple-events\");\r\nexports.SimpleEventDispatcher = simple_events_1.SimpleEventDispatcher;\r\nexports.SimpleEventHandlingBase = simple_events_1.SimpleEventHandlingBase;\r\nexports.SimpleEventList = simple_events_1.SimpleEventList;\r\n","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ste_core_1 = require(\"ste-core\");\r\n/**\r\n * The dispatcher handles the storage of subsciptions and facilitates\r\n * subscription, unsubscription and dispatching of a signal event.\r\n */\r\nvar SignalDispatcher = /** @class */ (function (_super) {\r\n    __extends(SignalDispatcher, _super);\r\n    /**\r\n     * Creates a new SignalDispatcher instance.\r\n     */\r\n    function SignalDispatcher() {\r\n        return _super.call(this) || this;\r\n    }\r\n    /**\r\n     * Dispatches the signal.\r\n     */\r\n    SignalDispatcher.prototype.dispatch = function () {\r\n        this._dispatch(false, this, arguments);\r\n    };\r\n    /**\r\n     * Dispatches the signal threaded.\r\n     */\r\n    SignalDispatcher.prototype.dispatchAsync = function () {\r\n        this._dispatch(true, this, arguments);\r\n    };\r\n    /**\r\n     * Creates an event from the dispatcher. Will return the dispatcher\r\n     * in a wrapper. This will prevent exposure of any dispatcher methods.\r\n     */\r\n    SignalDispatcher.prototype.asEvent = function () {\r\n        return _super.prototype.asEvent.call(this);\r\n    };\r\n    return SignalDispatcher;\r\n}(ste_core_1.DispatcherBase));\r\nexports.SignalDispatcher = SignalDispatcher;\r\n/**\r\n * Storage class for multiple signal events that are accessible by name.\r\n * Events dispatchers are automatically created.\r\n */\r\nvar SignalList = /** @class */ (function (_super) {\r\n    __extends(SignalList, _super);\r\n    /**\r\n     * Creates a new SignalList instance.\r\n     */\r\n    function SignalList() {\r\n        return _super.call(this) || this;\r\n    }\r\n    /**\r\n     * Creates a new dispatcher instance.\r\n     */\r\n    SignalList.prototype.createDispatcher = function () {\r\n        return new SignalDispatcher();\r\n    };\r\n    return SignalList;\r\n}(ste_core_1.EventListBase));\r\nexports.SignalList = SignalList;\r\n/**\r\n * Extends objects with signal event handling capabilities.\r\n */\r\nvar SignalHandlingBase = /** @class */ (function () {\r\n    function SignalHandlingBase() {\r\n        this._events = new SignalList();\r\n    }\r\n    Object.defineProperty(SignalHandlingBase.prototype, \"events\", {\r\n        get: function () {\r\n            return this._events;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Subscribes once to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SignalHandlingBase.prototype.one = function (name, fn) {\r\n        this._events.get(name).one(fn);\r\n    };\r\n    /**\r\n     * Checks it the event has a subscription for the specified handler.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SignalHandlingBase.prototype.has = function (name, fn) {\r\n        return this._events.get(name).has(fn);\r\n    };\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SignalHandlingBase.prototype.subscribe = function (name, fn) {\r\n        this._events.get(name).subscribe(fn);\r\n    };\r\n    /**\r\n     * Subscribes to the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SignalHandlingBase.prototype.sub = function (name, fn) {\r\n        this.subscribe(name, fn);\r\n    };\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SignalHandlingBase.prototype.unsubscribe = function (name, fn) {\r\n        this._events.get(name).unsubscribe(fn);\r\n    };\r\n    /**\r\n     * Unsubscribes from the event with the specified name.\r\n     * @param name The name of the event.\r\n     * @param fn The event handler.\r\n     */\r\n    SignalHandlingBase.prototype.unsub = function (name, fn) {\r\n        this.unsubscribe(name, fn);\r\n    };\r\n    return SignalHandlingBase;\r\n}());\r\nexports.SignalHandlingBase = SignalHandlingBase;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar signals_1 = require(\"./signals\");\r\nexports.SignalDispatcher = signals_1.SignalDispatcher;\r\nexports.SignalHandlingBase = signals_1.SignalHandlingBase;\r\nexports.SignalList = signals_1.SignalList;\r\n","\"use strict\";\r\n/*!\r\n * Strongly Typed Events for TypeScript\r\n * https://github.com/KeesCBakker/StronlyTypedEvents/\r\n * http://keestalkstech.com\r\n *\r\n * Copyright Kees C. Bakker / KeesTalksTech\r\n * Released under the MIT license\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ste_core_1 = require(\"ste-core\");\r\nexports.DispatcherBase = ste_core_1.DispatcherBase;\r\nexports.DispatcherWrapper = ste_core_1.DispatcherWrapper;\r\nexports.EventListBase = ste_core_1.EventListBase;\r\nexports.Subscription = ste_core_1.Subscription;\r\nvar ste_events_1 = require(\"ste-events\");\r\nexports.EventDispatcher = ste_events_1.EventDispatcher;\r\nexports.EventHandlingBase = ste_events_1.EventHandlingBase;\r\nexports.EventList = ste_events_1.EventList;\r\nvar ste_simple_events_1 = require(\"ste-simple-events\");\r\nexports.SimpleEventDispatcher = ste_simple_events_1.SimpleEventDispatcher;\r\nexports.SimpleEventHandlingBase = ste_simple_events_1.SimpleEventHandlingBase;\r\nexports.SimpleEventList = ste_simple_events_1.SimpleEventList;\r\nvar ste_signals_1 = require(\"ste-signals\");\r\nexports.SignalDispatcher = ste_signals_1.SignalDispatcher;\r\nexports.SignalHandlingBase = ste_signals_1.SignalHandlingBase;\r\nexports.SignalList = ste_signals_1.SignalList;\r\n","import { SimpleEventDispatcher } from \"strongly-typed-events\";\n\nconst TraktTokensKey: string = 'trakt_tokens';\n\nexport interface ITraktIDs {\n  trakt?: number;\n  slug?: string;\n  imdb?: string;\n  tmdb?: number;\n  tvdb?: number;\n}\n\nexport interface ITraktMovie {\n  title?: string;\n  year?: number;\n  ids?: ITraktIDs;\n}\n\nexport interface ITraktShow {\n  title?: string;\n  year?: number;\n  ids?: ITraktIDs;\n}\n\nexport interface ITraktSeason {\n  number?: number;\n  ids?: ITraktIDs;\n  episodes?: Array<ITraktEpisode>;\n}\n\nexport interface ITraktEpisode {\n  season?: number;\n  number?: number;\n  title?: string;\n  number_abs?: number;\n  ids?: ITraktIDs;\n}\n\nexport interface ITraktHistoryItem {\n  id?: number;\n  watched_at: string;\n  action: 'scrobble' | 'checkin' | 'watch';\n  type: 'movie' | 'episode';\n  movie?: ITraktMovie;\n  show?: ITraktShow;\n  episode?: ITraktEpisode;\n}\n\nexport interface ITraktSearchResult {\n  type: 'movie' | 'show' | 'episode' | 'person' | 'list';\n  score: number;\n  movie?: ITraktMovie;\n  show?: ITraktShow;\n  episode?: ITraktEpisode;\n}\n\nexport interface ITraktScrobbleData {\n  movie?: ITraktMovie;\n  show?: ITraktShow;\n  episode?: ITraktEpisode;\n  progress: number;\n  app_version: string;\n  app_date: string;\n}\n\nexport interface ITraktScobbleResult {\n  id: number;\n  action: 'start' | 'pause' | 'scrobble';\n  movie?: ITraktMovie;\n  show?: ITraktShow;\n  episode?: ITraktEpisode;\n}\n\nexport interface ITraktHistoryRemoveResult {\n  deleted: {\n    movies: number;\n    episodes: number;\n  };\n  not_found: {\n    movies: ITraktMovie[];\n    shows: ITraktShow[];\n    seasons: ITraktSeason[];\n    episodes: ITraktEpisode[];\n    ids: number[];\n  };\n}\n\nexport interface ITraktError {\n  status: number;\n  error: string;\n}\n\nconst TraktErrorCodes: { [key: number]: ITraktError } = {\n  200: { \"status\": 200, \"error\": \"Success\" },\n  201: { \"status\": 201, \"error\": \"Success - new resource created (POST)\" },\n  204: { \"status\": 204, \"error\": \"Success - no content to return (DELETE)\" },\n  400: { \"status\": 400, \"error\": \"Bad Request - request couldn't be parsed\" },\n  401: { \"status\": 401, \"error\": \"Unauthorized - OAuth must be provided\" },\n  403: { \"status\": 403, \"error\": \"Forbidden - invalid API key or unapproved app\" },\n  404: { \"status\": 404, \"error\": \"Not Found - method exists, but no record found\" },\n  405: { \"status\": 405, \"error\": \"Method Not Found - method doesn't exist\" },\n  409: { \"status\": 409, \"error\": \"Conflict - resource already created\" },\n  412: { \"status\": 412, \"error\": \"Precondition Failed - use application/json content type\" },\n  422: { \"status\": 422, \"error\": \"Unprocessible Entity - validation errors\" },\n  429: { \"status\": 429, \"error\": \"Rate Limit Exceeded\" },\n  500: { \"status\": 500, \"error\": \"Server Error - please open a support issue\" },\n  503: { \"status\": 503, \"error\": \"Service Unavailable - server overloaded (try again in 30s)\" },\n  504: { \"status\": 504, \"error\": \"Service Unavailable - server overloaded (try again in 30s)\" },\n  520: { \"status\": 520, \"error\": \"Service Unavailable - Cloudflare error\" },\n  521: { \"status\": 521, \"error\": \"Service Unavailable - Cloudflare error\" },\n  522: { \"status\": 522, \"error\": \"Service Unavailable - Cloudflare error\" }\n};\n\ninterface ITraktTokens {\n  refresh_token?: string;\n  access_token?: string;\n  expires?: number;\n  authentication_state?: string;\n}\n\nexport interface ITraktApiOptions {\n  client_id: string;\n  client_secret: string;\n  api_url?: string;\n  storage?: IStorage;\n}\n\nexport interface IStorage {\n  getValue(name: string): Promise<string>;\n  setValue(name: string, value: string): Promise<void>;\n}\n\nexport class LocalStorageAdapter implements IStorage {\n  getValue(name: string): Promise<string> {\n    return Promise.resolve(window.localStorage.getItem(name));\n  }\n  \n  setValue(name: string, value: string): Promise<void> {\n    if (!value) {\n      window.localStorage.removeItem(name);\n    } else {\n      window.localStorage.setItem(name, value);\n    }\n    return Promise.resolve();\n  }\n}\n\nexport class GreaseMonkeyStorageAdapter implements IStorage {\n  getValue(name: string): Promise<string> {\n    return Promise.resolve(GM_getValue(name));\n  }\n  \n  setValue(name: string, value: string): Promise<void> {\n    if (!value) {\n      GM_deleteValue(name);\n    } else {\n      GM_setValue(name, value);\n    }\n    return Promise.resolve();\n  }\n}\n\nexport default class TraktApi {\n  public onAuthenticationChanged = new SimpleEventDispatcher<boolean>();\n\n  private _tokens: ITraktTokens = {};\n\n  private _client_id: string;\n  private _client_secret: string;\n  private _redirect_uri: string;\n  private _endpoint: string;\n\n  private _storage: IStorage;\n\n  constructor(options: ITraktApiOptions) {\n    this._client_id = options.client_id;\n    this._client_secret = options.client_secret;\n    this._redirect_uri = 'https://www.crunchyroll.com';\n    this._endpoint = options.api_url || 'https://api.trakt.tv';\n    this._storage = options.storage || new LocalStorageAdapter();\n  }\n\n  static isError(obj: any, code?: number): obj is ITraktError {\n    const err = obj as ITraktError;\n    return err.status !== undefined && err.error !== undefined\n      && (code === undefined || err.status === code);\n  }\n\n  // ------ Authentication ------\n\n  public async loadTokens(): Promise<void> {\n    const data = await this._storage.getValue(TraktTokensKey);\n    if (data) {\n      this._tokens = JSON.parse(data);\n    } else {\n      this._tokens = {};\n    }\n\n    if (this._tokens.expires && this._tokens.expires < Date.now()) {\n      this._tokens = await this._refresh_token();\n      await this._storage.setValue(TraktTokensKey, JSON.stringify(this._tokens));\n    }\n\n    this.onAuthenticationChanged.dispatch(this.isAuthenticated());\n  }\n\n  isAuthenticated(): boolean {\n    return this._tokens.access_token !== undefined;\n  }\n\n  async authenticate(): Promise<void> {\n    const state = this._generate_state();\n    const url = this._get_url(state);\n\n    // Save authentication state data\n    this._tokens.authentication_state = state;\n    await this._storage.setValue(TraktTokensKey, JSON.stringify(this._tokens));\n\n    window.location.href = url;\n  }\n\n  async checkAuthenticationResult(url: string): Promise<void> {\n    const params = new URL(url).searchParams;\n    const code = params.get('code');\n    const state = params.get('state');\n    if (!code ||!state) return;\n\n    if (!await this._exchange_code(code, state)) {\n      console.error('Exchanging oauth code failed!');\n      return;\n    }\n\n    console.log('Trakt authentication successful!');\n\n    await this._storage.setValue(TraktTokensKey, JSON.stringify(this._tokens));\n\n    window.history.replaceState(null, undefined, window.location.pathname);\n\n    this.onAuthenticationChanged.dispatch(true);\n  }\n\n  disconnect(): void {\n    this._storage.setValue(TraktTokensKey, null);\n    this.onAuthenticationChanged.dispatch(false);\n    this._revoke_token();\n  }\n\n  // ------ API ------\n\n  private _getError(response: Response): ITraktError {\n    var error = TraktErrorCodes[response.status];\n    if (error) return error;\n\n    return {\n      status: response.status,\n      error: `Unknown error (${response.statusText})`\n    };\n  }\n\n  private async _request(method: 'GET' | 'POST' |'DELETE', url: string, body?: any): Promise<any> {\n    let contentType = null;\n    if (body) {\n      if (body.contentType) {\n        contentType = body.contentType;\n        body = body.body;\n      }\n\n      if (typeof body !== 'string') {\n        body = JSON.stringify(body);\n      }\n    }\n\n    let headers = new Headers();\n    headers.append('trakt-api-version', '2');\n    headers.append('trakt-api-key', this._client_id);\n    headers.append('Content-Type', contentType || 'application/json');\n\n    if (this._tokens && this._tokens.access_token) {\n      headers.append('Authorization', `Bearer ${this._tokens.access_token}`);\n    }\n\n    try {\n      let response = await fetch(this._endpoint + url, {\n        method: method,\n        mode: \"cors\",\n        headers: headers,\n        body: body\n      });\n\n      if (!response.ok) {\n        return this._getError(response);\n      }\n\n      if (response.status === 204) {\n        return null; // 204: No Content\n      }\n\n      return response.json();\n    } catch (err) {\n      return {\n        status: 0,\n        error: `An error occurred sending the request: ${err}`\n      };\n    }\n  }\n\n  private async _exchange(body: object): Promise<ITraktTokens> {\n    try {\n      const data = await this._request('POST', '/oauth/token', body);\n      return {\n        access_token: data.access_token,\n        refresh_token: data.refresh_token,\n        expires: (data.created_at + data.expires_in) * 1000\n      };\n    } catch (err) {\n      console.error(err);\n      return {};\n    }\n  }\n\n  private _generate_state(): string {\n    let data = new Uint32Array(4);\n    crypto.getRandomValues(data);\n    let state = '';\n    for (let i = 0; i < data.length; i++) {\n      state += data[i].toString(16);\n    }\n    return state;\n  }\n\n  private _get_url(state: string): string {\n     // Replace 'api' from the api_url to get the top level trakt domain\n     const base_url = this._endpoint.replace(/api\\W/, '');\n     return `${base_url}/oauth/authorize?response_type=code&client_id=${this._client_id}&redirect_uri=${this._redirect_uri}&state=${state}`;\n  }\n\n  private async _exchange_code(code: string, state: string): Promise<boolean> {\n    if (state !== this._tokens.authentication_state) {\n      console.error('Invalid CSRF (State)');\n      return false;\n    }\n\n    this._tokens = await this._exchange({\n      code: code,\n      client_id: this._client_id,\n      client_secret: this._client_secret,\n      redirect_uri: this._redirect_uri,\n      grant_type: 'authorization_code'\n    });\n    return this.isAuthenticated();\n  }\n\n  private async _refresh_token(): Promise<ITraktTokens> {\n    if (!this._tokens.refresh_token)\n      return {};\n\n    return await this._exchange({\n      refresh_token: this._tokens.refresh_token,\n      client_id: this._client_id,\n      client_secret: this._client_secret,\n      redirect_uri: this._redirect_uri,\n      grant_type: 'refresh_token'\n    });\n  }\n\n  private async _revoke_token(): Promise<{} | ITraktError> {\n    if (!this._tokens.access_token) return;\n\n    return this._request('POST', '/oauth/revoke', { \n      token: this._tokens.access_token,\n      client_id: this._client_id,\n      client_secret: this._client_secret\n    });\n  }\n\n  async search(type: string, query: string): Promise<Array<ITraktSearchResult> | ITraktError> {\n    return this._request('GET', `/search/${type}?query=${encodeURIComponent(query)}`);\n  }\n\n  async seasons(showId: number |string, extended?: Array<'full' | 'episodes'>): Promise<Array<ITraktSeason> | ITraktError> {\n    let query = extended ? '?extended=' + extended.join(\",\") : '';\n    return this._request('GET', `/shows/${showId}/seasons${query}`);\n  }\n\n  async season(showId: number |string, season: number, extended?: boolean): Promise<Array<ITraktEpisode> | ITraktError> {\n    return this._request('GET', `/shows/${showId}/seasons/${season}?extended=${extended ? 'full' : ''}`);\n  }\n\n  async scrobble(type: 'start' | 'pause' | 'stop', data: ITraktScrobbleData): Promise<ITraktScobbleResult | ITraktError> {\n    if (!this._tokens.access_token) {\n      throw new Error('Access token required.');\n    }\n    return this._request('POST', `/scrobble/${type}`, data);\n  }\n\n  async history(type?: 'movies' | 'shows' | 'seasons' | 'episodes', id?: number): Promise<ITraktHistoryItem[] | ITraktError> {\n    if (!this._tokens.access_token) {\n      throw new Error('Access token required.');\n    }\n\n    let url = '/sync/history';\n    if (type) url += '/' + type;\n    if (type && id) url += '/' + id;\n    return this._request('GET', url);\n  }\n\n  async historyRemove(id: number): Promise<ITraktHistoryRemoveResult | ITraktError> {\n    if (!this._tokens.access_token) {\n      throw new Error('Access token required.');\n    }\n\n    return this._request('POST', `/sync/history/remove`, { ids: [ id ] });\n  }\n}","import TraktApi, { ITraktScrobbleData, ITraktError, ITraktShow, ITraktSearchResult, ITraktScobbleResult, ITraktSeason } from './TraktApi';\nimport { SimpleEventDispatcher } from 'ste-simple-events';\n\nexport enum PlaybackState {\n  Paused,\n  Playing,\n  Ended\n}\n\nexport enum TraktScrobbleState {\n  Undefined,\n  Lookup,\n  Found,\n  Started,\n  Paused,\n  Scrobbled,\n  NotFound,\n  Error\n}\n\nenum LookupResult {\n  NotFound,\n  Found,\n  Error\n}\n\nexport default class TraktScrobble {\n  /** Extract item type from scrobble data */\n  public static typeFromData(data: ITraktScrobbleData): 'movie' | 'episode' | null {\n    if (!data) return null;\n    if (data.movie) return 'movie';\n    if (data.show && data.episode) return 'episode';\n    return null;\n  }\n\n  /** Extract trakt id from scrobble data, returns 0 if id is not set */\n  public static traktIdFromData(data: ITraktScrobbleData): number {\n    if (!data) return 0;\n    let movieId = data.movie && data.movie.ids && data.movie.ids.trakt || null;\n    if (movieId) return movieId;\n    let episodeId = data.episode && data.episode.ids && data.episode.ids.trakt || null;\n    if (episodeId) return episodeId;\n    return 0;\n  }\n\n  /** Scrobble once this percentage has been reached */\n  public scrobbleAbovePecentage: number = 80;\n  /** Minimum time of the video that has to have been played before scrobbling (percent of duration) */\n  public scrobbleMimimumPlaybackPercentage: number = 0.1;\n\n  public onStateChanged = new SimpleEventDispatcher<TraktScrobbleState>();\n  public onScrobbled = new SimpleEventDispatcher<ITraktScobbleResult>();\n\n  private _client: TraktApi;\n  private _data: ITraktScrobbleData;\n\n  private _state: TraktScrobbleState;\n  private _pendingState: TraktScrobbleState;\n  private _playbackState: PlaybackState;\n  private _error: string;\n  private _enabled: boolean = false;\n\n  private _lastPlaybackTime: number = 0;\n  private _playbackTime: number = 0;\n\n  constructor(client: TraktApi, data: ITraktScrobbleData) {\n    this._client = client;\n    this._data = data;\n\n    this._init();\n  }\n\n  public get api(): TraktApi {\n    return this._client;\n  }\n\n  public get enabled(): boolean {\n    return this._enabled;\n  }\n\n  public set enabled(value: boolean) {\n    if (this._enabled === value) return;\n\n    this._enabled = value;\n\n    if (this._enabled) {\n      this._applyState(PlaybackState.Paused);\n    } else {\n      this._applyState(this._playbackState);\n    }\n  }\n\n  public setPlaybackTime(time: number, duration: number) {\n    let delta = time - this._lastPlaybackTime;\n    if (delta < 0.5) {\n      this._playbackTime += delta;\n    }\n\n    let progress = time / duration * 100;\n    let minimumTime = duration * this.scrobbleMimimumPlaybackPercentage;\n    if (this._state === TraktScrobbleState.Started \n        && progress > this.scrobbleAbovePecentage\n        && this._playbackTime > minimumTime) {\n      this.setPlaybackState(PlaybackState.Ended, progress);\n    }\n\n    this._lastPlaybackTime = time;\n  }\n\n  public setPlaybackState(state: PlaybackState, progress: number): void {\n    this._playbackState = state;\n    this._data.progress = progress;\n\n    if (!this.enabled) {\n      this._applyState(state);\n    }\n  }\n\n  public scrobbleNow() {\n    this._playbackState = PlaybackState.Ended;\n    this._data.progress = 100;\n    this._applyState(this._playbackState);\n  }\n\n  private _applyState(state: PlaybackState) {\n    if (state === PlaybackState.Playing) {\n      if (this._pendingState === TraktScrobbleState.Found \n          || this._pendingState === TraktScrobbleState.Paused) {\n        this._updateScrobble('start');\n      }\n    } else if (state === PlaybackState.Paused) {\n      if (this._pendingState === TraktScrobbleState.Started) {\n        this._updateScrobble('pause');\n      }\n    } else if (state === PlaybackState.Ended) {\n      if (this._pendingState === TraktScrobbleState.Found \n          || this._pendingState === TraktScrobbleState.Started \n          || this._pendingState === TraktScrobbleState.Paused) {\n        this._updateScrobble('stop');\n      }\n    }\n  }\n\n  public get error(): string {\n    return this._error;\n  }\n\n  public scrobbleUrl(): string {\n    let url = 'https://trakt.tv/';\n    if (this._data.movie !== undefined) {\n      return url + `movies/${this._data.movie.ids!.slug}`;\n    } else if (this._data.show !== undefined && this._data.episode !== undefined) {\n      const show = this._data.show;\n      const episode = this._data.episode;\n      return url + `shows/${show.ids!.slug}/seasons/${episode.season}/episodes/${episode.number}`;\n    }\n    return '';\n  }\n\n  public get state(): TraktScrobbleState {\n    return this._state;\n  }\n\n  private setState(value: TraktScrobbleState): void {\n    if (this._state == value) return;\n    this._state = value;\n    this._pendingState = value;\n    this.onStateChanged.dispatch(value);\n  }\n\n  public get data(): ITraktScrobbleData {\n    return this._data;\n  }\n\n  private _handleError(response: any): response is ITraktError {\n    if (!TraktApi.isError(response)) return false;\n  \n    console.error(`trakt scrobbler: ${response.error}`);\n    this._error = response.error;\n    this.setState(TraktScrobbleState.Error);\n    return true;\n  }\n\n  private async _init(): Promise<void> {\n    this.setState(TraktScrobbleState.Lookup);\n\n    let result = await this._lookup();\n    if (result === LookupResult.NotFound) {\n      this.setState(TraktScrobbleState.NotFound);\n      return;\n    } else if (result === LookupResult.Error) {\n      this.setState(TraktScrobbleState.Error);\n      return;\n    }\n\n    this.setState(TraktScrobbleState.Found);\n\n    if (this._playbackState === PlaybackState.Playing) {\n      this._updateScrobble('start');\n    } else if (this._playbackState === PlaybackState.Ended) {\n      this._updateScrobble('stop');\n    }\n  }\n\n  private async _updateScrobble(type: 'start' | 'pause' | 'stop'): Promise<boolean> {\n    switch (type) {\n      case 'start':\n        this._pendingState = TraktScrobbleState.Started;\n        break;\n      case 'pause':\n        this._pendingState = TraktScrobbleState.Paused;\n        break;\n      case 'stop':\n        this._pendingState = TraktScrobbleState.Scrobbled;\n        break;\n    }\n\n    let scrobbleResponse = await this._client.scrobble(type, this._data);\n    if (this._handleError(scrobbleResponse)) {\n      return false;\n    }\n\n    switch (this._state) {\n      case TraktScrobbleState.Found:\n      case TraktScrobbleState.Started:\n      case TraktScrobbleState.Paused:\n        switch (scrobbleResponse.action) {\n          case 'start':\n            this.setState(TraktScrobbleState.Started);\n            break;\n          case 'pause':\n            this.setState(TraktScrobbleState.Paused);\n            break;\n          case 'scrobble':\n            this.setState(TraktScrobbleState.Scrobbled);\n            this.onScrobbled.dispatch(scrobbleResponse);\n            break;\n        }\n        break;\n    }\n\n    return true;\n  }\n\n  private async _lookup(): Promise<LookupResult> {\n    if (this._data.movie === undefined && (this._data.show === undefined || this._data.episode === undefined)) {\n      console.error('trakt scrobbler: either movie or show/episode needs to be set on scrobble data');\n      return LookupResult.Error;\n    }\n\n    console.log('trakt scrobbler: looking up media on trakt...', Object.assign({}, this._data));\n\n    let type: 'movie' | 'show' = this._data.movie !== undefined ? 'movie' : 'show';\n    let result: LookupResult;\n  \n    // Special episodes with fractional episode numbers, e.g. 14.5\n    // (Often used for recap episodes)\n    let isSpecialEp = this._data.episode && (this._data.episode.number % 1) !== 0;\n\n    if (!isSpecialEp) {\n      // Start with trakt's automatic matching\n      console.log('trakt scrobbler: trying automatic matching...');\n      result = await this._scrobbleLookup();\n      if (result !== LookupResult.NotFound) return result;\n\n      // Retry automatic matching with absolute episode number\n      if (type === 'show' && this._data.episode.number_abs === undefined && this._data.episode.number !== undefined) {\n        let data = JSON.parse(JSON.stringify(this._data)) as ITraktScrobbleData;\n        data.episode.number_abs = data.episode.number;\n        delete data.episode.number;\n        \n        result = await this._scrobbleLookup(data);\n        if (result !== LookupResult.NotFound) return result;\n      }\n    }\n\n    // Search for item manually\n    let title = this._data.movie !== undefined ? this._data.movie.title : this._data.show!.title;\n    if (!title) {\n      console.error('trakt scrobbler: No title set');\n      return LookupResult.Error;\n    }\n    console.log('trakt scrobbler: trying to search manually...');\n    const results = await this._search(type, title);\n    if (results === null) return LookupResult.Error;\n    if (results.length === 0) {\n      console.warn(`trakt scrobbler: manual search for \"${title}\" returned no results`);\n      return LookupResult.NotFound;\n    }\n\n    // Try search results in order\n    for (const found of results) {\n      if (type === 'movie') {\n        console.log(`trakt scrobbler: trying result ${found.movie!.title}`, found);\n        this._data.movie = found.movie;\n      } else {\n        console.log(`trakt scrobbler: trying result ${found.show!.title}`, found);\n        this._data.show = found.show;\n      }\n\n      // Look up episode for shows\n      if (type === 'show') {\n        result = await this._lookupEpisode(found.show!);\n        if (result === LookupResult.Error) return result;\n        if (result === LookupResult.NotFound) continue;\n      }\n\n      // Retry start with new data\n      console.log('trakt scrobbler: re-trying matching');\n      result = await this._scrobbleLookup();\n      if (result === LookupResult.Error) return result;\n      if (result === LookupResult.Found) break;\n    }\n\n    return result;\n  }\n\n  private async _scrobbleLookup(data?: ITraktScrobbleData): Promise<LookupResult> {\n    let scrobbleResponse = await this._client.scrobble('pause', data || this._data);\n    if (TraktApi.isError(scrobbleResponse, 404)) {\n      return LookupResult.NotFound;\n    } else if (this._handleError(scrobbleResponse)) {\n      return LookupResult.Error;\n    }\n\n    if (scrobbleResponse.movie !== undefined)   this._data.movie = scrobbleResponse.movie;\n    if (scrobbleResponse.show !== undefined)    this._data.show = scrobbleResponse.show;\n    if (scrobbleResponse.episode !== undefined) this._data.episode = scrobbleResponse.episode;\n\n    console.log('trakt scrobbler: scrobble lookup succeeded', scrobbleResponse);\n    return LookupResult.Found;\n  }\n\n  private async _search(type: 'movie' | 'show', title: string): Promise<Array<ITraktSearchResult> | null> {\n    const searchResponse = await this._client.search(type, title);\n    if (this._handleError(searchResponse)) {\n      return null;\n    }\n\n    const goodMatches = searchResponse.filter(r => r.score > 10);\n    if (searchResponse.length > goodMatches.length) {\n      if (goodMatches.length === 0) {\n        console.log(`trakt scrobbler: search returned only garbage results.`);\n      } else {\n        console.log(`trakt scrobbler: some search results with low scores ignored`);\n      }\n    }\n    return goodMatches;\n  }\n\n  private async _lookupEpisode(show: ITraktShow): Promise<LookupResult> {\n    if (this._data.episode === undefined || this._data.episode.number === undefined || this._data.episode.season === undefined) {\n      console.error('trakt scrobbler: data has show but episode is not set or incomplete', this._data.episode);\n      return LookupResult.Error;\n    }\n    if (show.ids === undefined || show.ids.trakt === undefined) {\n      console.error('trakt scrobbler: show data is missing trakt id', this._data.show);\n      return LookupResult.Error;\n    }\n\n    let episodeResult = LookupResult.NotFound;\n\n    const seasonsResponse = await this._client.seasons(show.ids.trakt, ['episodes', 'full']);\n    if (TraktApi.isError(seasonsResponse, 404)) {\n      console.error('trakt scrobbler: manual lookup could not find seasons');\n      return LookupResult.NotFound;\n    } else if (this._handleError(seasonsResponse)) {\n      return LookupResult.Error;\n    }\n\n    // First search in matching season\n    const season = seasonsResponse.find(s => s.number === this._data.episode.season);\n    if (!season) {\n      console.warn(`trakt scrobbler: could not find season ${this._data.episode.season} in seasons response`, seasonsResponse);\n    } else {\n      episodeResult = this._matchEpisodeOrTitle(season, this._data.episode.number, this._data.episode.title);\n    }\n\n    // Look through all other seasons\n    if (episodeResult === LookupResult.NotFound) {\n      for (let s of seasonsResponse) {\n        if (s === season) continue;\n        episodeResult = this._matchEpisodeOrTitle(s, this._data.episode.number, this._data.episode.title);\n        if (episodeResult == LookupResult.Found) break;\n      }\n    }\n\n    return episodeResult;\n  }\n\n  private _matchEpisodeOrTitle(season: ITraktSeason, episode: number, title: string): LookupResult {\n    let numberMatch = season.episodes.filter(e => e.number === episode || e.number_abs === episode);\n    if (numberMatch.length > 1) {\n      console.error(`trakt scrobbler: got multiple episode #${episode} in season`, season);\n      return LookupResult.NotFound;\n    } else if (numberMatch.length == 1) {\n      console.log(`trakt scrobbler: found episode using episode number`, numberMatch[0]);\n      this._data.episode = numberMatch[0];\n      return LookupResult.Found;\n    }\n\n    if (title) {\n      const filteredTitle = this._filterEpisodeTitle(title);\n      let titleMatch = season.episodes\n        .filter(e => e.title && this._filterEpisodeTitle(e.title) === filteredTitle);\n      if (titleMatch.length > 1) {\n        console.error(`trakt scrobbler: got multiple episodes titled \"${title}\" in show`, season);\n        return LookupResult.NotFound;\n      } else if (titleMatch.length == 1) {\n        console.log(`trakt scrobbler: found episode using episode title`, titleMatch[0]);\n        this._data.episode = titleMatch[0];\n        return LookupResult.Found;\n      }\n    }\n\n    return LookupResult.NotFound;\n  }\n\n  private _filterEpisodeTitle(title: string): string {\n    if (!title) debugger;\n    return title.replace(/[^\\w\\s]/gi, '').toLowerCase();\n  }\n}","/**\n * Virtual DOM Node\n * @typedef VNode\n * @property {string | function} nodeName The string of the DOM node to create or Component constructor to render\n * @property {Array<VNode | string>} children The children of node\n * @property {string | number | undefined} key The key used to identify this VNode in a list\n * @property {object} attributes The properties of this VNode\n */\nexport const VNode = function VNode() {};\n","/**\n * @typedef {import('./component').Component} Component\n * @typedef {import('./vnode').VNode} VNode\n */\n\n/**\n * Global options\n * @public\n * @typedef Options\n * @property {boolean} [syncComponentUpdates] If `true`, `prop` changes trigger synchronous component updates. Defaults to true.\n * @property {(vnode: VNode) => void} [vnode] Processes all created VNodes.\n * @property {(component: Component) => void} [afterMount] Hook invoked after a component is mounted.\n * @property {(component: Component) => void} [afterUpdate] Hook invoked after the DOM is updated with a component's latest render.\n * @property {(component: Component) => void} [beforeUnmount] Hook invoked immediately before a component is unmounted.\n * @property {(rerender: function) => void} [debounceRendering] Hook invoked whenever a rerender is requested. Can be used to debounce rerenders.\n * @property {(event: Event) => Event | void} [event] Hook invoked before any Preact event listeners. The return value (if any) replaces the native browser event given to event listeners\n */\n\n/** @type {Options}  */\nconst options = {};\n\nexport default options;\n","import { VNode } from './vnode';\nimport options from './options';\n\n\nconst stack = [];\n\nconst EMPTY_CHILDREN = [];\n\n/**\n * JSX/hyperscript reviver.\n * @see http://jasonformat.com/wtf-is-jsx\n * Benchmarks: https://esbench.com/bench/57ee8f8e330ab09900a1a1a0\n *\n * Note: this is exported as both `h()` and `createElement()` for compatibility\n * reasons.\n *\n * Creates a VNode (virtual DOM element). A tree of VNodes can be used as a\n * lightweight representation of the structure of a DOM tree. This structure can\n * be realized by recursively comparing it against the current _actual_ DOM\n * structure, and applying only the differences.\n *\n * `h()`/`createElement()` accepts an element name, a list of attributes/props,\n * and optionally children to append to the element.\n *\n * @example The following DOM tree\n *\n * `<div id=\"foo\" name=\"bar\">Hello!</div>`\n *\n * can be constructed using this function as:\n *\n * `h('div', { id: 'foo', name : 'bar' }, 'Hello!');`\n *\n * @param {string | function} nodeName An element name. Ex: `div`, `a`, `span`, etc.\n * @param {object | null} attributes Any attributes/props to set on the created element.\n * @param {VNode[]} [rest] Additional arguments are taken to be children to\n *  append. Can be infinitely nested Arrays.\n *\n * @public\n */\nexport function h(nodeName, attributes) {\n\tlet children=EMPTY_CHILDREN, lastSimple, child, simple, i;\n\tfor (i=arguments.length; i-- > 2; ) {\n\t\tstack.push(arguments[i]);\n\t}\n\tif (attributes && attributes.children!=null) {\n\t\tif (!stack.length) stack.push(attributes.children);\n\t\tdelete attributes.children;\n\t}\n\twhile (stack.length) {\n\t\tif ((child = stack.pop()) && child.pop!==undefined) {\n\t\t\tfor (i=child.length; i--; ) stack.push(child[i]);\n\t\t}\n\t\telse {\n\t\t\tif (typeof child==='boolean') child = null;\n\n\t\t\tif ((simple = typeof nodeName!=='function')) {\n\t\t\t\tif (child==null) child = '';\n\t\t\t\telse if (typeof child==='number') child = String(child);\n\t\t\t\telse if (typeof child!=='string') simple = false;\n\t\t\t}\n\n\t\t\tif (simple && lastSimple) {\n\t\t\t\tchildren[children.length-1] += child;\n\t\t\t}\n\t\t\telse if (children===EMPTY_CHILDREN) {\n\t\t\t\tchildren = [child];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\n\t\t\tlastSimple = simple;\n\t\t}\n\t}\n\n\tlet p = new VNode();\n\tp.nodeName = nodeName;\n\tp.children = children;\n\tp.attributes = attributes==null ? undefined : attributes;\n\tp.key = attributes==null ? undefined : attributes.key;\n\n\t// if a \"vnode hook\" is defined, pass every created VNode to it\n\tif (options.vnode!==undefined) options.vnode(p);\n\n\treturn p;\n}\n","/**\n * Copy all properties from `props` onto `obj`.\n * @param {object} obj Object onto which properties should be copied.\n * @param {object} props Object from which to copy properties.\n * @returns {object}\n * @private\n */\nexport function extend(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn obj;\n}\n\n/** Invoke or update a ref, depending on whether it is a function or object ref.\n *  @param {object|function} [ref=null]\n *  @param {any} [value]\n */\nexport function applyRef(ref, value) {\n\tif (ref!=null) {\n\t\tif (typeof ref=='function') ref(value);\n\t\telse ref.current = value;\n\t}\n}\n\n/**\n * Call a function asynchronously, as soon as possible. Makes\n * use of HTML Promise to schedule the callback if available,\n * otherwise falling back to `setTimeout` (mainly for IE<11).\n * @type {(callback: function) => void}\n */\nexport const defer = typeof Promise=='function' ? Promise.resolve().then.bind(Promise.resolve()) : setTimeout;\n","import { extend } from './util';\nimport { h } from './h';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its\n * children.\n * @param {import('./vnode').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./vnode').VNode>} [rest] Any additional arguments will be used as replacement\n *  children.\n */\nexport function cloneElement(vnode, props) {\n\treturn h(\n\t\tvnode.nodeName,\n\t\textend(extend({}, vnode.attributes), props),\n\t\targuments.length>2 ? [].slice.call(arguments, 2) : vnode.children\n\t);\n}\n","// render modes\n\n/** Do not re-render a component */\nexport const NO_RENDER = 0;\n/** Synchronously re-render a component and its children */\nexport const SYNC_RENDER = 1;\n/** Synchronously re-render a component, even if its lifecycle methods attempt to prevent it. */\nexport const FORCE_RENDER = 2;\n/** Queue asynchronous re-render of a component and it's children */\nexport const ASYNC_RENDER = 3;\n\n\nexport const ATTR_KEY = '__preactattr_';\n\n/** DOM properties that should NOT have \"px\" added when numeric */\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n\n","import options from './options';\nimport { defer } from './util';\nimport { renderComponent } from './vdom/component';\n\n/**\n * Managed queue of dirty components to be re-rendered\n * @type {Array<import('./component').Component>}\n */\nlet items = [];\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./component').Component} component The component to rerender\n */\nexport function enqueueRender(component) {\n\tif (!component._dirty && (component._dirty = true) && items.push(component)==1) {\n\t\t(options.debounceRendering || defer)(rerender);\n\t}\n}\n\n/** Rerender all enqueued dirty components */\nexport function rerender() {\n\tlet p;\n\twhile ( (p = items.pop()) ) {\n\t\tif (p._dirty) renderComponent(p);\n\t}\n}\n","import { extend } from '../util';\n\n\n/**\n * Check if two nodes are equivalent.\n * @param {import('../dom').PreactElement} node DOM Node to compare\n * @param {import('../vnode').VNode} vnode Virtual DOM node to compare\n * @param {boolean} [hydrating=false] If true, ignores component constructors\n *  when comparing.\n * @private\n */\nexport function isSameNodeType(node, vnode, hydrating) {\n\tif (typeof vnode==='string' || typeof vnode==='number') {\n\t\treturn node.splitText!==undefined;\n\t}\n\tif (typeof vnode.nodeName==='string') {\n\t\treturn !node._componentConstructor && isNamedNode(node, vnode.nodeName);\n\t}\n\treturn hydrating || node._componentConstructor===vnode.nodeName;\n}\n\n\n/**\n * Check if an Element has a given nodeName, case-insensitively.\n * @param {import('../dom').PreactElement} node A DOM Element to inspect the name of.\n * @param {string} nodeName Unnormalized name to compare against.\n */\nexport function isNamedNode(node, nodeName) {\n\treturn node.normalizedNodeName===nodeName || node.nodeName.toLowerCase()===nodeName.toLowerCase();\n}\n\n\n/**\n * Reconstruct Component-style `props` from a VNode.\n * Ensures default/fallback values from `defaultProps`:\n * Own-properties of `defaultProps` not present in `vnode.attributes` are added.\n * @param {import('../vnode').VNode} vnode The VNode to get props for\n * @returns {object} The props to use for this VNode\n */\nexport function getNodeProps(vnode) {\n\tlet props = extend({}, vnode.attributes);\n\tprops.children = vnode.children;\n\n\tlet defaultProps = vnode.nodeName.defaultProps;\n\tif (defaultProps!==undefined) {\n\t\tfor (let i in defaultProps) {\n\t\t\tif (props[i]===undefined) {\n\t\t\t\tprops[i] = defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn props;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport { applyRef } from '../util';\nimport options from '../options';\n\n/**\n * A DOM event listener\n * @typedef {(e: Event) => void} EventListner\n */\n\n/**\n * A mapping of event types to event listeners\n * @typedef {Object.<string, EventListener>} EventListenerMap\n */\n\n/**\n * Properties Preact adds to elements it creates\n * @typedef PreactElementExtensions\n * @property {string} [normalizedNodeName] A normalized node name to use in diffing\n * @property {EventListenerMap} [_listeners] A map of event listeners added by components to this DOM node\n * @property {import('../component').Component} [_component] The component that rendered this DOM node\n * @property {function} [_componentConstructor] The constructor of the component that rendered this DOM node\n */\n\n/**\n * A DOM element that has been extended with Preact properties\n * @typedef {Element & ElementCSSInlineStyle & PreactElementExtensions} PreactElement\n */\n\n/**\n * Create an element with the given nodeName.\n * @param {string} nodeName The DOM node to create\n * @param {boolean} [isSvg=false] If `true`, creates an element within the SVG\n *  namespace.\n * @returns {PreactElement} The created DOM node\n */\nexport function createNode(nodeName, isSvg) {\n\t/** @type {PreactElement} */\n\tlet node = isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName);\n\tnode.normalizedNodeName = nodeName;\n\treturn node;\n}\n\n\n/**\n * Remove a child node from its parent if attached.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\n\n/**\n * Set a named attribute on the given Node, with special behavior for some names\n * and event handlers. If `value` is `null`, the attribute/handler will be\n * removed.\n * @param {PreactElement} node An element to mutate\n * @param {string} name The name/key to set, such as an event or attribute name\n * @param {*} old The last value that was set for this name/node pair\n * @param {*} value An attribute value, such as a function to be used as an\n *  event handler\n * @param {boolean} isSvg Are we currently diffing inside an svg?\n * @private\n */\nexport function setAccessor(node, name, old, value, isSvg) {\n\tif (name==='className') name = 'class';\n\n\n\tif (name==='key') {\n\t\t// ignore\n\t}\n\telse if (name==='ref') {\n\t\tapplyRef(old, null);\n\t\tapplyRef(value, node);\n\t}\n\telse if (name==='class' && !isSvg) {\n\t\tnode.className = value || '';\n\t}\n\telse if (name==='style') {\n\t\tif (!value || typeof value==='string' || typeof old==='string') {\n\t\t\tnode.style.cssText = value || '';\n\t\t}\n\t\tif (value && typeof value==='object') {\n\t\t\tif (typeof old!=='string') {\n\t\t\t\tfor (let i in old) if (!(i in value)) node.style[i] = '';\n\t\t\t}\n\t\t\tfor (let i in value) {\n\t\t\t\tnode.style[i] = typeof value[i]==='number' && IS_NON_DIMENSIONAL.test(i)===false ? (value[i]+'px') : value[i];\n\t\t\t}\n\t\t}\n\t}\n\telse if (name==='dangerouslySetInnerHTML') {\n\t\tif (value) node.innerHTML = value.__html || '';\n\t}\n\telse if (name[0]=='o' && name[1]=='n') {\n\t\tlet useCapture = name !== (name=name.replace(/Capture$/, ''));\n\t\tname = name.toLowerCase().substring(2);\n\t\tif (value) {\n\t\t\tif (!old) node.addEventListener(name, eventProxy, useCapture);\n\t\t}\n\t\telse {\n\t\t\tnode.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t\t(node._listeners || (node._listeners = {}))[name] = value;\n\t}\n\telse if (name!=='list' && name!=='type' && !isSvg && name in node) {\n\t\t// Attempt to set a DOM property to the given value.\n\t\t// IE & FF throw for certain property-value combinations.\n\t\ttry {\n\t\t\tnode[name] = value==null ? '' : value;\n\t\t} catch (e) { }\n\t\tif ((value==null || value===false) && name!='spellcheck') node.removeAttribute(name);\n\t}\n\telse {\n\t\tlet ns = isSvg && (name !== (name = name.replace(/^xlink:?/, '')));\n\t\t// spellcheck is treated differently than all other boolean values and\n\t\t// should not be removed when the value is `false`. See:\n\t\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#attr-spellcheck\n\t\tif (value==null || value===false) {\n\t\t\tif (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase());\n\t\t\telse node.removeAttribute(name);\n\t\t}\n\t\telse if (typeof value!=='function') {\n\t\t\tif (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', name.toLowerCase(), value);\n\t\t\telse node.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\treturn this._listeners[e.type](options.event && options.event(e) || e);\n}\n","import { ATTR_KEY } from '../constants';\nimport { isSameNodeType, isNamedNode } from './index';\nimport { buildComponentFromVNode } from './component';\nimport { createNode, setAccessor } from '../dom/index';\nimport { unmountComponent } from './component';\nimport options from '../options';\nimport { applyRef } from '../util';\nimport { removeNode } from '../dom/index';\n\n/**\n * Queue of components that have been mounted and are awaiting componentDidMount\n * @type {Array<import('../component').Component>}\n */\nexport const mounts = [];\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nexport let diffLevel = 0;\n\n/** Global flag indicating if the diff is currently within an SVG */\nlet isSvgMode = false;\n\n/** Global flag indicating if the diff is performing hydration */\nlet hydrating = false;\n\n/** Invoke queued componentDidMount lifecycle methods */\nexport function flushMounts() {\n\tlet c;\n\twhile ((c = mounts.shift())) {\n\t\tif (options.afterMount) options.afterMount(c);\n\t\tif (c.componentDidMount) c.componentDidMount();\n\t}\n}\n\n\n/**\n * Apply differences in a given vnode (and it's deep children) to a real DOM Node.\n * @param {import('../dom').PreactElement} dom A DOM node to mutate into the shape of a `vnode`\n * @param {import('../vnode').VNode} vnode A VNode (with descendants forming a tree) representing\n *  the desired DOM structure\n * @param {object} context The current context\n * @param {boolean} mountAll Whether or not to immediately mount all components\n * @param {Element} parent ?\n * @param {boolean} componentRoot ?\n * @returns {import('../dom').PreactElement} The created/mutated element\n * @private\n */\nexport function diff(dom, vnode, context, mountAll, parent, componentRoot) {\n\t// diffLevel having been 0 here indicates initial entry into the diff (not a subdiff)\n\tif (!diffLevel++) {\n\t\t// when first starting the diff, check if we're diffing an SVG or within an SVG\n\t\tisSvgMode = parent!=null && parent.ownerSVGElement!==undefined;\n\n\t\t// hydration is indicated by the existing element to be diffed not having a prop cache\n\t\thydrating = dom!=null && !(ATTR_KEY in dom);\n\t}\n\n\tlet ret = idiff(dom, vnode, context, mountAll, componentRoot);\n\n\t// append the element if its a new parent\n\tif (parent && ret.parentNode!==parent) parent.appendChild(ret);\n\n\t// diffLevel being reduced to 0 means we're exiting the diff\n\tif (!--diffLevel) {\n\t\thydrating = false;\n\t\t// invoke queued componentDidMount lifecycle methods\n\t\tif (!componentRoot) flushMounts();\n\t}\n\n\treturn ret;\n}\n\n\n/**\n * Internals of `diff()`, separated to allow bypassing diffLevel / mount flushing.\n * @param {import('../dom').PreactElement} dom A DOM node to mutate into the shape of a `vnode`\n * @param {import('../vnode').VNode} vnode A VNode (with descendants forming a tree) representing the desired DOM structure\n * @param {object} context The current context\n * @param {boolean} mountAll Whether or not to immediately mount all components\n * @param {boolean} [componentRoot] ?\n * @private\n */\nfunction idiff(dom, vnode, context, mountAll, componentRoot) {\n\tlet out = dom,\n\t\tprevSvgMode = isSvgMode;\n\n\t// empty values (null, undefined, booleans) render as empty Text nodes\n\tif (vnode==null || typeof vnode==='boolean') vnode = '';\n\n\n\t// Fast case: Strings & Numbers create/update Text nodes.\n\tif (typeof vnode==='string' || typeof vnode==='number') {\n\n\t\t// update if it's already a Text node:\n\t\tif (dom && dom.splitText!==undefined && dom.parentNode && (!dom._component || componentRoot)) {\n\t\t\t/* istanbul ignore if */ /* Browser quirk that can't be covered: https://github.com/developit/preact/commit/fd4f21f5c45dfd75151bd27b4c217d8003aa5eb9 */\n\t\t\tif (dom.nodeValue!=vnode) {\n\t\t\t\tdom.nodeValue = vnode;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// it wasn't a Text node: replace it with one and recycle the old Element\n\t\t\tout = document.createTextNode(vnode);\n\t\t\tif (dom) {\n\t\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\t\t\t\trecollectNodeTree(dom, true);\n\t\t\t}\n\t\t}\n\n\t\tout[ATTR_KEY] = true;\n\n\t\treturn out;\n\t}\n\n\n\t// If the VNode represents a Component, perform a component diff:\n\tlet vnodeName = vnode.nodeName;\n\tif (typeof vnodeName==='function') {\n\t\treturn buildComponentFromVNode(dom, vnode, context, mountAll);\n\t}\n\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvgMode = vnodeName==='svg' ? true : vnodeName==='foreignObject' ? false : isSvgMode;\n\n\n\t// If there's no existing element or it's the wrong type, create a new one:\n\tvnodeName = String(vnodeName);\n\tif (!dom || !isNamedNode(dom, vnodeName)) {\n\t\tout = createNode(vnodeName, isSvgMode);\n\n\t\tif (dom) {\n\t\t\t// move children into the replacement node\n\t\t\twhile (dom.firstChild) out.appendChild(dom.firstChild);\n\n\t\t\t// if the previous Element was mounted into the DOM, replace it inline\n\t\t\tif (dom.parentNode) dom.parentNode.replaceChild(out, dom);\n\n\t\t\t// recycle the old element (skips non-Element node types)\n\t\t\trecollectNodeTree(dom, true);\n\t\t}\n\t}\n\n\n\tlet fc = out.firstChild,\n\t\tprops = out[ATTR_KEY],\n\t\tvchildren = vnode.children;\n\n\tif (props==null) {\n\t\tprops = out[ATTR_KEY] = {};\n\t\tfor (let a=out.attributes, i=a.length; i--; ) props[a[i].name] = a[i].value;\n\t}\n\n\t// Optimization: fast-path for elements containing a single TextNode:\n\tif (!hydrating && vchildren && vchildren.length===1 && typeof vchildren[0]==='string' && fc!=null && fc.splitText!==undefined && fc.nextSibling==null) {\n\t\tif (fc.nodeValue!=vchildren[0]) {\n\t\t\tfc.nodeValue = vchildren[0];\n\t\t}\n\t}\n\t// otherwise, if there are existing or new children, diff them:\n\telse if (vchildren && vchildren.length || fc!=null) {\n\t\tinnerDiffNode(out, vchildren, context, mountAll, hydrating || props.dangerouslySetInnerHTML!=null);\n\t}\n\n\n\t// Apply attributes/props from VNode to the DOM Element:\n\tdiffAttributes(out, vnode.attributes, props);\n\n\n\t// restore previous SVG mode: (in case we're exiting an SVG namespace)\n\tisSvgMode = prevSvgMode;\n\n\treturn out;\n}\n\n\n/**\n * Apply child and attribute changes between a VNode and a DOM Node to the DOM.\n * @param {import('../dom').PreactElement} dom Element whose children should be compared & mutated\n * @param {Array<import('../vnode').VNode>} vchildren Array of VNodes to compare to `dom.childNodes`\n * @param {object} context Implicitly descendant context object (from most\n *  recent `getChildContext()`)\n * @param {boolean} mountAll Whether or not to immediately mount all components\n * @param {boolean} isHydrating if `true`, consumes externally created elements\n *  similar to hydration\n */\nfunction innerDiffNode(dom, vchildren, context, mountAll, isHydrating) {\n\tlet originalChildren = dom.childNodes,\n\t\tchildren = [],\n\t\tkeyed = {},\n\t\tkeyedLen = 0,\n\t\tmin = 0,\n\t\tlen = originalChildren.length,\n\t\tchildrenLen = 0,\n\t\tvlen = vchildren ? vchildren.length : 0,\n\t\tj, c, f, vchild, child;\n\n\t// Build up a map of keyed children and an Array of unkeyed children:\n\tif (len!==0) {\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet child = originalChildren[i],\n\t\t\t\tprops = child[ATTR_KEY],\n\t\t\t\tkey = vlen && props ? child._component ? child._component.__key : props.key : null;\n\t\t\tif (key!=null) {\n\t\t\t\tkeyedLen++;\n\t\t\t\tkeyed[key] = child;\n\t\t\t}\n\t\t\telse if (props || (child.splitText!==undefined ? (isHydrating ? child.nodeValue.trim() : true) : isHydrating)) {\n\t\t\t\tchildren[childrenLen++] = child;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (vlen!==0) {\n\t\tfor (let i=0; i<vlen; i++) {\n\t\t\tvchild = vchildren[i];\n\t\t\tchild = null;\n\n\t\t\t// attempt to find a node based on key matching\n\t\t\tlet key = vchild.key;\n\t\t\tif (key!=null) {\n\t\t\t\tif (keyedLen && keyed[key]!==undefined) {\n\t\t\t\t\tchild = keyed[key];\n\t\t\t\t\tkeyed[key] = undefined;\n\t\t\t\t\tkeyedLen--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// attempt to pluck a node of the same type from the existing children\n\t\t\telse if (min<childrenLen) {\n\t\t\t\tfor (j=min; j<childrenLen; j++) {\n\t\t\t\t\tif (children[j]!==undefined && isSameNodeType(c = children[j], vchild, isHydrating)) {\n\t\t\t\t\t\tchild = c;\n\t\t\t\t\t\tchildren[j] = undefined;\n\t\t\t\t\t\tif (j===childrenLen-1) childrenLen--;\n\t\t\t\t\t\tif (j===min) min++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// morph the matched/found/created DOM child to match vchild (deep)\n\t\t\tchild = idiff(child, vchild, context, mountAll);\n\n\t\t\tf = originalChildren[i];\n\t\t\tif (child && child!==dom && child!==f) {\n\t\t\t\tif (f==null) {\n\t\t\t\t\tdom.appendChild(child);\n\t\t\t\t}\n\t\t\t\telse if (child===f.nextSibling) {\n\t\t\t\t\tremoveNode(f);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdom.insertBefore(child, f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\t// remove unused keyed children:\n\tif (keyedLen) {\n\t\tfor (let i in keyed) if (keyed[i]!==undefined) recollectNodeTree(keyed[i], false);\n\t}\n\n\t// remove orphaned unkeyed children:\n\twhile (min<=childrenLen) {\n\t\tif ((child = children[childrenLen--])!==undefined) recollectNodeTree(child, false);\n\t}\n}\n\n\n\n/**\n * Recursively recycle (or just unmount) a node and its descendants.\n * @param {import('../dom').PreactElement} node DOM node to start\n *  unmount/removal from\n * @param {boolean} [unmountOnly=false] If `true`, only triggers unmount\n *  lifecycle, skips removal\n */\nexport function recollectNodeTree(node, unmountOnly) {\n\tlet component = node._component;\n\tif (component) {\n\t\t// if node is owned by a Component, unmount that component (ends up recursing back here)\n\t\tunmountComponent(component);\n\t}\n\telse {\n\t\t// If the node's VNode had a ref function, invoke it with null here.\n\t\t// (this is part of the React spec, and smart for unsetting references)\n\t\tif (node[ATTR_KEY]!=null) applyRef(node[ATTR_KEY].ref, null);\n\n\t\tif (unmountOnly===false || node[ATTR_KEY]==null) {\n\t\t\tremoveNode(node);\n\t\t}\n\n\t\tremoveChildren(node);\n\t}\n}\n\n\n/**\n * Recollect/unmount all children.\n *\t- we use .lastChild here because it causes less reflow than .firstChild\n *\t- it's also cheaper than accessing the .childNodes Live NodeList\n */\nexport function removeChildren(node) {\n\tnode = node.lastChild;\n\twhile (node) {\n\t\tlet next = node.previousSibling;\n\t\trecollectNodeTree(node, true);\n\t\tnode = next;\n\t}\n}\n\n\n/**\n * Apply differences in attributes from a VNode to the given DOM Element.\n * @param {import('../dom').PreactElement} dom Element with attributes to diff `attrs` against\n * @param {object} attrs The desired end-state key-value attribute pairs\n * @param {object} old Current/previous attributes (from previous VNode or\n *  element's prop cache)\n */\nfunction diffAttributes(dom, attrs, old) {\n\tlet name;\n\n\t// remove attributes no longer present on the vnode by setting them to undefined\n\tfor (name in old) {\n\t\tif (!(attrs && attrs[name]!=null) && old[name]!=null) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = undefined, isSvgMode);\n\t\t}\n\t}\n\n\t// add new & update changed attributes\n\tfor (name in attrs) {\n\t\tif (name!=='children' && name!=='innerHTML' && (!(name in old) || attrs[name]!==(name==='value' || name==='checked' ? dom[name] : old[name]))) {\n\t\t\tsetAccessor(dom, name, old[name], old[name] = attrs[name], isSvgMode);\n\t\t}\n\t}\n}\n","import { Component } from '../component';\n\n/**\n * Retains a pool of Components for re-use.\n * @type {Component[]}\n * @private\n */\nexport const recyclerComponents = [];\n\n\n/**\n * Create a component. Normalizes differences between PFC's and classful\n * Components.\n * @param {function} Ctor The constructor of the component to create\n * @param {object} props The initial props of the component\n * @param {object} context The initial context of the component\n * @returns {import('../component').Component}\n */\nexport function createComponent(Ctor, props, context) {\n\tlet inst, i = recyclerComponents.length;\n\n\tif (Ctor.prototype && Ctor.prototype.render) {\n\t\tinst = new Ctor(props, context);\n\t\tComponent.call(inst, props, context);\n\t}\n\telse {\n\t\tinst = new Component(props, context);\n\t\tinst.constructor = Ctor;\n\t\tinst.render = doRender;\n\t}\n\n\n\twhile (i--) {\n\t\tif (recyclerComponents[i].constructor===Ctor) {\n\t\t\tinst.nextBase = recyclerComponents[i].nextBase;\n\t\t\trecyclerComponents.splice(i, 1);\n\t\t\treturn inst;\n\t\t}\n\t}\n\n\treturn inst;\n}\n\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { SYNC_RENDER, NO_RENDER, FORCE_RENDER, ASYNC_RENDER, ATTR_KEY } from '../constants';\nimport options from '../options';\nimport { extend, applyRef } from '../util';\nimport { enqueueRender } from '../render-queue';\nimport { getNodeProps } from './index';\nimport { diff, mounts, diffLevel, flushMounts, recollectNodeTree, removeChildren } from './diff';\nimport { createComponent, recyclerComponents } from './component-recycler';\nimport { removeNode } from '../dom/index';\n\n/**\n * Set a component's `props` and possibly re-render the component\n * @param {import('../component').Component} component The Component to set props on\n * @param {object} props The new props\n * @param {number} renderMode Render options - specifies how to re-render the component\n * @param {object} context The new context\n * @param {boolean} mountAll Whether or not to immediately mount all components\n */\nexport function setComponentProps(component, props, renderMode, context, mountAll) {\n\tif (component._disable) return;\n\tcomponent._disable = true;\n\n\tcomponent.__ref = props.ref;\n\tcomponent.__key = props.key;\n\tdelete props.ref;\n\tdelete props.key;\n\n\tif (typeof component.constructor.getDerivedStateFromProps === 'undefined') {\n\t\tif (!component.base || mountAll) {\n\t\t\tif (component.componentWillMount) component.componentWillMount();\n\t\t}\n\t\telse if (component.componentWillReceiveProps) {\n\t\t\tcomponent.componentWillReceiveProps(props, context);\n\t\t}\n\t}\n\n\tif (context && context!==component.context) {\n\t\tif (!component.prevContext) component.prevContext = component.context;\n\t\tcomponent.context = context;\n\t}\n\n\tif (!component.prevProps) component.prevProps = component.props;\n\tcomponent.props = props;\n\n\tcomponent._disable = false;\n\n\tif (renderMode!==NO_RENDER) {\n\t\tif (renderMode===SYNC_RENDER || options.syncComponentUpdates!==false || !component.base) {\n\t\t\trenderComponent(component, SYNC_RENDER, mountAll);\n\t\t}\n\t\telse {\n\t\t\tenqueueRender(component);\n\t\t}\n\t}\n\n\tapplyRef(component.__ref, component);\n}\n\n\n\n/**\n * Render a Component, triggering necessary lifecycle events and taking\n * High-Order Components into account.\n * @param {import('../component').Component} component The component to render\n * @param {number} [renderMode] render mode, see constants.js for available options.\n * @param {boolean} [mountAll] Whether or not to immediately mount all components\n * @param {boolean} [isChild] ?\n * @private\n */\nexport function renderComponent(component, renderMode, mountAll, isChild) {\n\tif (component._disable) return;\n\n\tlet props = component.props,\n\t\tstate = component.state,\n\t\tcontext = component.context,\n\t\tpreviousProps = component.prevProps || props,\n\t\tpreviousState = component.prevState || state,\n\t\tpreviousContext = component.prevContext || context,\n\t\tisUpdate = component.base,\n\t\tnextBase = component.nextBase,\n\t\tinitialBase = isUpdate || nextBase,\n\t\tinitialChildComponent = component._component,\n\t\tskip = false,\n\t\tsnapshot = previousContext,\n\t\trendered, inst, cbase;\n\n\tif (component.constructor.getDerivedStateFromProps) {\n\t\tstate = extend(extend({}, state), component.constructor.getDerivedStateFromProps(props, state));\n\t\tcomponent.state = state;\n\t}\n\n\t// if updating\n\tif (isUpdate) {\n\t\tcomponent.props = previousProps;\n\t\tcomponent.state = previousState;\n\t\tcomponent.context = previousContext;\n\t\tif (renderMode!==FORCE_RENDER\n\t\t\t&& component.shouldComponentUpdate\n\t\t\t&& component.shouldComponentUpdate(props, state, context) === false) {\n\t\t\tskip = true;\n\t\t}\n\t\telse if (component.componentWillUpdate) {\n\t\t\tcomponent.componentWillUpdate(props, state, context);\n\t\t}\n\t\tcomponent.props = props;\n\t\tcomponent.state = state;\n\t\tcomponent.context = context;\n\t}\n\n\tcomponent.prevProps = component.prevState = component.prevContext = component.nextBase = null;\n\tcomponent._dirty = false;\n\n\tif (!skip) {\n\t\trendered = component.render(props, state, context);\n\n\t\t// context to pass to the child, can be updated via (grand-)parent component\n\t\tif (component.getChildContext) {\n\t\t\tcontext = extend(extend({}, context), component.getChildContext());\n\t\t}\n\n\t\tif (isUpdate && component.getSnapshotBeforeUpdate) {\n\t\t\tsnapshot = component.getSnapshotBeforeUpdate(previousProps, previousState);\n\t\t}\n\n\t\tlet childComponent = rendered && rendered.nodeName,\n\t\t\ttoUnmount, base;\n\n\t\tif (typeof childComponent==='function') {\n\t\t\t// set up high order component link\n\n\t\t\tlet childProps = getNodeProps(rendered);\n\t\t\tinst = initialChildComponent;\n\n\t\t\tif (inst && inst.constructor===childComponent && childProps.key==inst.__key) {\n\t\t\t\tsetComponentProps(inst, childProps, SYNC_RENDER, context, false);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoUnmount = inst;\n\n\t\t\t\tcomponent._component = inst = createComponent(childComponent, childProps, context);\n\t\t\t\tinst.nextBase = inst.nextBase || nextBase;\n\t\t\t\tinst._parentComponent = component;\n\t\t\t\tsetComponentProps(inst, childProps, NO_RENDER, context, false);\n\t\t\t\trenderComponent(inst, SYNC_RENDER, mountAll, true);\n\t\t\t}\n\n\t\t\tbase = inst.base;\n\t\t}\n\t\telse {\n\t\t\tcbase = initialBase;\n\n\t\t\t// destroy high order component link\n\t\t\ttoUnmount = initialChildComponent;\n\t\t\tif (toUnmount) {\n\t\t\t\tcbase = component._component = null;\n\t\t\t}\n\n\t\t\tif (initialBase || renderMode===SYNC_RENDER) {\n\t\t\t\tif (cbase) cbase._component = null;\n\t\t\t\tbase = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, true);\n\t\t\t}\n\t\t}\n\n\t\tif (initialBase && base!==initialBase && inst!==initialChildComponent) {\n\t\t\tlet baseParent = initialBase.parentNode;\n\t\t\tif (baseParent && base!==baseParent) {\n\t\t\t\tbaseParent.replaceChild(base, initialBase);\n\n\t\t\t\tif (!toUnmount) {\n\t\t\t\t\tinitialBase._component = null;\n\t\t\t\t\trecollectNodeTree(initialBase, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (toUnmount) {\n\t\t\tunmountComponent(toUnmount);\n\t\t}\n\n\t\tcomponent.base = base;\n\t\tif (base && !isChild) {\n\t\t\tlet componentRef = component,\n\t\t\t\tt = component;\n\t\t\twhile ((t=t._parentComponent)) {\n\t\t\t\t(componentRef = t).base = base;\n\t\t\t}\n\t\t\tbase._component = componentRef;\n\t\t\tbase._componentConstructor = componentRef.constructor;\n\t\t}\n\t}\n\n\tif (!isUpdate || mountAll) {\n\t\tmounts.push(component);\n\t}\n\telse if (!skip) {\n\t\t// Ensure that pending componentDidMount() hooks of child components\n\t\t// are called before the componentDidUpdate() hook in the parent.\n\t\t// Note: disabled as it causes duplicate hooks, see https://github.com/developit/preact/issues/750\n\t\t// flushMounts();\n\n\t\tif (component.componentDidUpdate) {\n\t\t\tcomponent.componentDidUpdate(previousProps, previousState, snapshot);\n\t\t}\n\t\tif (options.afterUpdate) options.afterUpdate(component);\n\t}\n\n\twhile (component._renderCallbacks.length) component._renderCallbacks.pop().call(component);\n\n\tif (!diffLevel && !isChild) flushMounts();\n}\n\n\n\n/**\n * Apply the Component referenced by a VNode to the DOM.\n * @param {import('../dom').PreactElement} dom The DOM node to mutate\n * @param {import('../vnode').VNode} vnode A Component-referencing VNode\n * @param {object} context The current context\n * @param {boolean} mountAll Whether or not to immediately mount all components\n * @returns {import('../dom').PreactElement} The created/mutated element\n * @private\n */\nexport function buildComponentFromVNode(dom, vnode, context, mountAll) {\n\tlet c = dom && dom._component,\n\t\toriginalComponent = c,\n\t\toldDom = dom,\n\t\tisDirectOwner = c && dom._componentConstructor===vnode.nodeName,\n\t\tisOwner = isDirectOwner,\n\t\tprops = getNodeProps(vnode);\n\twhile (c && !isOwner && (c=c._parentComponent)) {\n\t\tisOwner = c.constructor===vnode.nodeName;\n\t}\n\n\tif (c && isOwner && (!mountAll || c._component)) {\n\t\tsetComponentProps(c, props, ASYNC_RENDER, context, mountAll);\n\t\tdom = c.base;\n\t}\n\telse {\n\t\tif (originalComponent && !isDirectOwner) {\n\t\t\tunmountComponent(originalComponent);\n\t\t\tdom = oldDom = null;\n\t\t}\n\n\t\tc = createComponent(vnode.nodeName, props, context);\n\t\tif (dom && !c.nextBase) {\n\t\t\tc.nextBase = dom;\n\t\t\t// passing dom/oldDom as nextBase will recycle it if unused, so bypass recycling on L229:\n\t\t\toldDom = null;\n\t\t}\n\t\tsetComponentProps(c, props, SYNC_RENDER, context, mountAll);\n\t\tdom = c.base;\n\n\t\tif (oldDom && dom!==oldDom) {\n\t\t\toldDom._component = null;\n\t\t\trecollectNodeTree(oldDom, false);\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n\n\n/**\n * Remove a component from the DOM and recycle it.\n * @param {import('../component').Component} component The Component instance to unmount\n * @private\n */\nexport function unmountComponent(component) {\n\tif (options.beforeUnmount) options.beforeUnmount(component);\n\n\tlet base = component.base;\n\n\tcomponent._disable = true;\n\n\tif (component.componentWillUnmount) component.componentWillUnmount();\n\n\tcomponent.base = null;\n\n\t// recursively tear down & recollect high-order component children:\n\tlet inner = component._component;\n\tif (inner) {\n\t\tunmountComponent(inner);\n\t}\n\telse if (base) {\n\t\tif (base[ATTR_KEY]!=null) applyRef(base[ATTR_KEY].ref, null);\n\n\t\tcomponent.nextBase = base;\n\n\t\tremoveNode(base);\n\t\trecyclerComponents.push(component);\n\n\t\tremoveChildren(base);\n\t}\n\n\tapplyRef(component.__ref, null);\n}\n","import { FORCE_RENDER } from './constants';\nimport { extend } from './util';\nimport { renderComponent } from './vdom/component';\nimport { enqueueRender } from './render-queue';\n/**\n * Base Component class.\n * Provides `setState()` and `forceUpdate()`, which trigger rendering.\n * @typedef {object} Component\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components' getChildContext\n * @public\n *\n * @example\n * class MyFoo extends Component {\n *   render(props, state) {\n *     return <div />;\n *   }\n * }\n */\nexport function Component(props, context) {\n\tthis._dirty = true;\n\n\t/**\n\t * @public\n\t * @type {object}\n\t */\n\tthis.context = context;\n\n\t/**\n\t * @public\n\t * @type {object}\n\t */\n\tthis.props = props;\n\n\t/**\n\t * @public\n\t * @type {object}\n\t */\n\tthis.state = this.state || {};\n\n\tthis._renderCallbacks = [];\n}\n\n\nextend(Component.prototype, {\n\n\t/**\n\t * Update component state and schedule a re-render.\n\t * @param {object} state A dict of state properties to be shallowly merged\n\t * \tinto the current state, or a function that will produce such a dict. The\n\t * \tfunction is called with the current state and props.\n\t * @param {() => void} callback A function to be called once component state is\n\t * \tupdated\n\t */\n\tsetState(state, callback) {\n\t\tif (!this.prevState) this.prevState = this.state;\n\t\tthis.state = extend(\n\t\t\textend({}, this.state),\n\t\t\ttypeof state === 'function' ? state(this.state, this.props) : state\n\t\t);\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t},\n\n\n\t/**\n\t * Immediately perform a synchronous re-render of the component.\n\t * @param {() => void} callback A function to be called after component is\n\t * \tre-rendered.\n\t * @private\n\t */\n\tforceUpdate(callback) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\trenderComponent(this, FORCE_RENDER);\n\t},\n\n\n\t/**\n\t * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n\t * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n\t * @param {object} props Props (eg: JSX attributes) received from parent\n\t * \telement/component\n\t * @param {object} state The component's current state\n\t * @param {object} context Context object, as returned by the nearest\n\t *  ancestor's `getChildContext()`\n\t * @returns {import('./vnode').VNode | void}\n\t */\n\trender() {}\n\n});\n","import { diff } from './vdom/diff';\n\n/**\n * Render JSX into a `parent` Element.\n * @param {import('./vnode').VNode} vnode A (JSX) VNode to render\n * @param {import('./dom').PreactElement} parent DOM element to render into\n * @param {import('./dom').PreactElement} [merge] Attempt to re-use an existing DOM tree rooted at\n *  `merge`\n * @public\n *\n * @example\n * // render a div into <body>:\n * render(<div id=\"hello\">hello!</div>, document.body);\n *\n * @example\n * // render a \"Thing\" component into #foo:\n * const Thing = ({ name }) => <span>{ name }</span>;\n * render(<Thing name=\"one\" />, document.querySelector('#foo'));\n */\nexport function render(vnode, parent, merge) {\n\treturn diff(merge, vnode, {}, false, parent, false);\n}\n","import { h, h as createElement } from './h';\nimport { cloneElement } from './clone-element';\nimport { Component } from './component';\nimport { render } from './render';\nimport { rerender } from './render-queue';\nimport options from './options';\n\nfunction createRef() {\n\treturn {};\n}\n\nexport default {\n\th,\n\tcreateElement,\n\tcloneElement,\n\tcreateRef,\n\tComponent,\n\trender,\n\trerender,\n\toptions\n};\n\nexport {\n\th,\n\tcreateElement,\n\tcloneElement,\n\tcreateRef,\n\tComponent,\n\trender,\n\trerender,\n\toptions\n};\n","/*\n\nBased off glamor's StyleSheet, thanks Sunil \n\nhigh performance StyleSheet for css-in-js systems\n\n- uses multiple style tags behind the scenes for millions of rules\n- uses `insertRule` for appending in production for *much* faster performance\n\n// usage\n\nimport { StyleSheet } from '@emotion/sheet'\n\nlet styleSheet = new StyleSheet({ key: '', container: document.head })\n\nstyleSheet.insert('#box { border: 1px solid red; }')\n- appends a css rule into the stylesheet\n\nstyleSheet.flush()\n- empties the stylesheet of all its contents\n\n*/\n// $FlowFixMe\nfunction sheetForTag(tag) {\n  if (tag.sheet) {\n    // $FlowFixMe\n    return tag.sheet;\n  } // this weirdness brought to you by firefox\n\n  /* istanbul ignore next */\n\n\n  for (var i = 0; i < document.styleSheets.length; i++) {\n    if (document.styleSheets[i].ownerNode === tag) {\n      // $FlowFixMe\n      return document.styleSheets[i];\n    }\n  }\n}\n\nfunction createStyleElement(options) {\n  var tag = document.createElement('style');\n  tag.setAttribute('data-emotion', options.key);\n\n  if (options.nonce !== undefined) {\n    tag.setAttribute('nonce', options.nonce);\n  }\n\n  tag.appendChild(document.createTextNode(''));\n  return tag;\n}\n\nvar StyleSheet =\n/*#__PURE__*/\nfunction () {\n  function StyleSheet(options) {\n    this.isSpeedy = options.speedy === undefined ? process.env.NODE_ENV === 'production' : options.speedy;\n    this.tags = [];\n    this.ctr = 0;\n    this.nonce = options.nonce; // key is the value of the data-emotion attribute, it's used to identify different sheets\n\n    this.key = options.key;\n    this.container = options.container;\n    this.before = null;\n  }\n\n  var _proto = StyleSheet.prototype;\n\n  _proto.insert = function insert(rule) {\n    // the max length is how many rules we have per style tag, it's 65000 in speedy mode\n    // it's 1 in dev because we insert source maps that map a single rule to a location\n    // and you can only have one source map per style tag\n    if (this.ctr % (this.isSpeedy ? 65000 : 1) === 0) {\n      var _tag = createStyleElement(this);\n\n      var before;\n\n      if (this.tags.length === 0) {\n        before = this.before;\n      } else {\n        before = this.tags[this.tags.length - 1].nextSibling;\n      }\n\n      this.container.insertBefore(_tag, before);\n      this.tags.push(_tag);\n    }\n\n    var tag = this.tags[this.tags.length - 1];\n\n    if (this.isSpeedy) {\n      var sheet = sheetForTag(tag);\n\n      try {\n        // this is a really hot path\n        // we check the second character first because having \"i\"\n        // as the second character will happen less often than\n        // having \"@\" as the first character\n        var isImportRule = rule.charCodeAt(1) === 105 && rule.charCodeAt(0) === 64; // this is the ultrafast version, works across browsers\n        // the big drawback is that the css won't be editable in devtools\n\n        sheet.insertRule(rule, // we need to insert @import rules before anything else\n        // otherwise there will be an error\n        // technically this means that the @import rules will\n        // _usually_(not always since there could be multiple style tags)\n        // be the first ones in prod and generally later in dev\n        // this shouldn't really matter in the real world though\n        // @import is generally only used for font faces from google fonts and etc.\n        // so while this could be technically correct then it would be slower and larger\n        // for a tiny bit of correctness that won't matter in the real world\n        isImportRule ? 0 : sheet.cssRules.length);\n      } catch (e) {\n        if (process.env.NODE_ENV !== 'production') {\n          console.warn(\"There was a problem inserting the following rule: \\\"\" + rule + \"\\\"\", e);\n        }\n      }\n    } else {\n      tag.appendChild(document.createTextNode(rule));\n    }\n\n    this.ctr++;\n  };\n\n  _proto.flush = function flush() {\n    // $FlowFixMe\n    this.tags.forEach(function (tag) {\n      return tag.parentNode.removeChild(tag);\n    });\n    this.tags = [];\n    this.ctr = 0;\n  };\n\n  return StyleSheet;\n}();\n\nexport { StyleSheet };\n","function stylis_min (W) {\n  function M(d, c, e, h, a) {\n    for (var m = 0, b = 0, v = 0, n = 0, q, g, x = 0, K = 0, k, u = k = q = 0, l = 0, r = 0, I = 0, t = 0, B = e.length, J = B - 1, y, f = '', p = '', F = '', G = '', C; l < B;) {\n      g = e.charCodeAt(l);\n      l === J && 0 !== b + n + v + m && (0 !== b && (g = 47 === b ? 10 : 47), n = v = m = 0, B++, J++);\n\n      if (0 === b + n + v + m) {\n        if (l === J && (0 < r && (f = f.replace(N, '')), 0 < f.trim().length)) {\n          switch (g) {\n            case 32:\n            case 9:\n            case 59:\n            case 13:\n            case 10:\n              break;\n\n            default:\n              f += e.charAt(l);\n          }\n\n          g = 59;\n        }\n\n        switch (g) {\n          case 123:\n            f = f.trim();\n            q = f.charCodeAt(0);\n            k = 1;\n\n            for (t = ++l; l < B;) {\n              switch (g = e.charCodeAt(l)) {\n                case 123:\n                  k++;\n                  break;\n\n                case 125:\n                  k--;\n                  break;\n\n                case 47:\n                  switch (g = e.charCodeAt(l + 1)) {\n                    case 42:\n                    case 47:\n                      a: {\n                        for (u = l + 1; u < J; ++u) {\n                          switch (e.charCodeAt(u)) {\n                            case 47:\n                              if (42 === g && 42 === e.charCodeAt(u - 1) && l + 2 !== u) {\n                                l = u + 1;\n                                break a;\n                              }\n\n                              break;\n\n                            case 10:\n                              if (47 === g) {\n                                l = u + 1;\n                                break a;\n                              }\n\n                          }\n                        }\n\n                        l = u;\n                      }\n\n                  }\n\n                  break;\n\n                case 91:\n                  g++;\n\n                case 40:\n                  g++;\n\n                case 34:\n                case 39:\n                  for (; l++ < J && e.charCodeAt(l) !== g;) {\n                  }\n\n              }\n\n              if (0 === k) break;\n              l++;\n            }\n\n            k = e.substring(t, l);\n            0 === q && (q = (f = f.replace(ca, '').trim()).charCodeAt(0));\n\n            switch (q) {\n              case 64:\n                0 < r && (f = f.replace(N, ''));\n                g = f.charCodeAt(1);\n\n                switch (g) {\n                  case 100:\n                  case 109:\n                  case 115:\n                  case 45:\n                    r = c;\n                    break;\n\n                  default:\n                    r = O;\n                }\n\n                k = M(c, r, k, g, a + 1);\n                t = k.length;\n                0 < A && (r = X(O, f, I), C = H(3, k, r, c, D, z, t, g, a, h), f = r.join(''), void 0 !== C && 0 === (t = (k = C.trim()).length) && (g = 0, k = ''));\n                if (0 < t) switch (g) {\n                  case 115:\n                    f = f.replace(da, ea);\n\n                  case 100:\n                  case 109:\n                  case 45:\n                    k = f + '{' + k + '}';\n                    break;\n\n                  case 107:\n                    f = f.replace(fa, '$1 $2');\n                    k = f + '{' + k + '}';\n                    k = 1 === w || 2 === w && L('@' + k, 3) ? '@-webkit-' + k + '@' + k : '@' + k;\n                    break;\n\n                  default:\n                    k = f + k, 112 === h && (k = (p += k, ''));\n                } else k = '';\n                break;\n\n              default:\n                k = M(c, X(c, f, I), k, h, a + 1);\n            }\n\n            F += k;\n            k = I = r = u = q = 0;\n            f = '';\n            g = e.charCodeAt(++l);\n            break;\n\n          case 125:\n          case 59:\n            f = (0 < r ? f.replace(N, '') : f).trim();\n            if (1 < (t = f.length)) switch (0 === u && (q = f.charCodeAt(0), 45 === q || 96 < q && 123 > q) && (t = (f = f.replace(' ', ':')).length), 0 < A && void 0 !== (C = H(1, f, c, d, D, z, p.length, h, a, h)) && 0 === (t = (f = C.trim()).length) && (f = '\\x00\\x00'), q = f.charCodeAt(0), g = f.charCodeAt(1), q) {\n              case 0:\n                break;\n\n              case 64:\n                if (105 === g || 99 === g) {\n                  G += f + e.charAt(l);\n                  break;\n                }\n\n              default:\n                58 !== f.charCodeAt(t - 1) && (p += P(f, q, g, f.charCodeAt(2)));\n            }\n            I = r = u = q = 0;\n            f = '';\n            g = e.charCodeAt(++l);\n        }\n      }\n\n      switch (g) {\n        case 13:\n        case 10:\n          47 === b ? b = 0 : 0 === 1 + q && 107 !== h && 0 < f.length && (r = 1, f += '\\x00');\n          0 < A * Y && H(0, f, c, d, D, z, p.length, h, a, h);\n          z = 1;\n          D++;\n          break;\n\n        case 59:\n        case 125:\n          if (0 === b + n + v + m) {\n            z++;\n            break;\n          }\n\n        default:\n          z++;\n          y = e.charAt(l);\n\n          switch (g) {\n            case 9:\n            case 32:\n              if (0 === n + m + b) switch (x) {\n                case 44:\n                case 58:\n                case 9:\n                case 32:\n                  y = '';\n                  break;\n\n                default:\n                  32 !== g && (y = ' ');\n              }\n              break;\n\n            case 0:\n              y = '\\\\0';\n              break;\n\n            case 12:\n              y = '\\\\f';\n              break;\n\n            case 11:\n              y = '\\\\v';\n              break;\n\n            case 38:\n              0 === n + b + m && (r = I = 1, y = '\\f' + y);\n              break;\n\n            case 108:\n              if (0 === n + b + m + E && 0 < u) switch (l - u) {\n                case 2:\n                  112 === x && 58 === e.charCodeAt(l - 3) && (E = x);\n\n                case 8:\n                  111 === K && (E = K);\n              }\n              break;\n\n            case 58:\n              0 === n + b + m && (u = l);\n              break;\n\n            case 44:\n              0 === b + v + n + m && (r = 1, y += '\\r');\n              break;\n\n            case 34:\n            case 39:\n              0 === b && (n = n === g ? 0 : 0 === n ? g : n);\n              break;\n\n            case 91:\n              0 === n + b + v && m++;\n              break;\n\n            case 93:\n              0 === n + b + v && m--;\n              break;\n\n            case 41:\n              0 === n + b + m && v--;\n              break;\n\n            case 40:\n              if (0 === n + b + m) {\n                if (0 === q) switch (2 * x + 3 * K) {\n                  case 533:\n                    break;\n\n                  default:\n                    q = 1;\n                }\n                v++;\n              }\n\n              break;\n\n            case 64:\n              0 === b + v + n + m + u + k && (k = 1);\n              break;\n\n            case 42:\n            case 47:\n              if (!(0 < n + m + v)) switch (b) {\n                case 0:\n                  switch (2 * g + 3 * e.charCodeAt(l + 1)) {\n                    case 235:\n                      b = 47;\n                      break;\n\n                    case 220:\n                      t = l, b = 42;\n                  }\n\n                  break;\n\n                case 42:\n                  47 === g && 42 === x && t + 2 !== l && (33 === e.charCodeAt(t + 2) && (p += e.substring(t, l + 1)), y = '', b = 0);\n              }\n          }\n\n          0 === b && (f += y);\n      }\n\n      K = x;\n      x = g;\n      l++;\n    }\n\n    t = p.length;\n\n    if (0 < t) {\n      r = c;\n      if (0 < A && (C = H(2, p, r, d, D, z, t, h, a, h), void 0 !== C && 0 === (p = C).length)) return G + p + F;\n      p = r.join(',') + '{' + p + '}';\n\n      if (0 !== w * E) {\n        2 !== w || L(p, 2) || (E = 0);\n\n        switch (E) {\n          case 111:\n            p = p.replace(ha, ':-moz-$1') + p;\n            break;\n\n          case 112:\n            p = p.replace(Q, '::-webkit-input-$1') + p.replace(Q, '::-moz-$1') + p.replace(Q, ':-ms-input-$1') + p;\n        }\n\n        E = 0;\n      }\n    }\n\n    return G + p + F;\n  }\n\n  function X(d, c, e) {\n    var h = c.trim().split(ia);\n    c = h;\n    var a = h.length,\n        m = d.length;\n\n    switch (m) {\n      case 0:\n      case 1:\n        var b = 0;\n\n        for (d = 0 === m ? '' : d[0] + ' '; b < a; ++b) {\n          c[b] = Z(d, c[b], e, m).trim();\n        }\n\n        break;\n\n      default:\n        var v = b = 0;\n\n        for (c = []; b < a; ++b) {\n          for (var n = 0; n < m; ++n) {\n            c[v++] = Z(d[n] + ' ', h[b], e, m).trim();\n          }\n        }\n\n    }\n\n    return c;\n  }\n\n  function Z(d, c, e) {\n    var h = c.charCodeAt(0);\n    33 > h && (h = (c = c.trim()).charCodeAt(0));\n\n    switch (h) {\n      case 38:\n        return c.replace(F, '$1' + d.trim());\n\n      case 58:\n        return d.trim() + c.replace(F, '$1' + d.trim());\n\n      default:\n        if (0 < 1 * e && 0 < c.indexOf('\\f')) return c.replace(F, (58 === d.charCodeAt(0) ? '' : '$1') + d.trim());\n    }\n\n    return d + c;\n  }\n\n  function P(d, c, e, h) {\n    var a = d + ';',\n        m = 2 * c + 3 * e + 4 * h;\n\n    if (944 === m) {\n      d = a.indexOf(':', 9) + 1;\n      var b = a.substring(d, a.length - 1).trim();\n      b = a.substring(0, d).trim() + b + ';';\n      return 1 === w || 2 === w && L(b, 1) ? '-webkit-' + b + b : b;\n    }\n\n    if (0 === w || 2 === w && !L(a, 1)) return a;\n\n    switch (m) {\n      case 1015:\n        return 97 === a.charCodeAt(10) ? '-webkit-' + a + a : a;\n\n      case 951:\n        return 116 === a.charCodeAt(3) ? '-webkit-' + a + a : a;\n\n      case 963:\n        return 110 === a.charCodeAt(5) ? '-webkit-' + a + a : a;\n\n      case 1009:\n        if (100 !== a.charCodeAt(4)) break;\n\n      case 969:\n      case 942:\n        return '-webkit-' + a + a;\n\n      case 978:\n        return '-webkit-' + a + '-moz-' + a + a;\n\n      case 1019:\n      case 983:\n        return '-webkit-' + a + '-moz-' + a + '-ms-' + a + a;\n\n      case 883:\n        if (45 === a.charCodeAt(8)) return '-webkit-' + a + a;\n        if (0 < a.indexOf('image-set(', 11)) return a.replace(ja, '$1-webkit-$2') + a;\n        break;\n\n      case 932:\n        if (45 === a.charCodeAt(4)) switch (a.charCodeAt(5)) {\n          case 103:\n            return '-webkit-box-' + a.replace('-grow', '') + '-webkit-' + a + '-ms-' + a.replace('grow', 'positive') + a;\n\n          case 115:\n            return '-webkit-' + a + '-ms-' + a.replace('shrink', 'negative') + a;\n\n          case 98:\n            return '-webkit-' + a + '-ms-' + a.replace('basis', 'preferred-size') + a;\n        }\n        return '-webkit-' + a + '-ms-' + a + a;\n\n      case 964:\n        return '-webkit-' + a + '-ms-flex-' + a + a;\n\n      case 1023:\n        if (99 !== a.charCodeAt(8)) break;\n        b = a.substring(a.indexOf(':', 15)).replace('flex-', '').replace('space-between', 'justify');\n        return '-webkit-box-pack' + b + '-webkit-' + a + '-ms-flex-pack' + b + a;\n\n      case 1005:\n        return ka.test(a) ? a.replace(aa, ':-webkit-') + a.replace(aa, ':-moz-') + a : a;\n\n      case 1e3:\n        b = a.substring(13).trim();\n        c = b.indexOf('-') + 1;\n\n        switch (b.charCodeAt(0) + b.charCodeAt(c)) {\n          case 226:\n            b = a.replace(G, 'tb');\n            break;\n\n          case 232:\n            b = a.replace(G, 'tb-rl');\n            break;\n\n          case 220:\n            b = a.replace(G, 'lr');\n            break;\n\n          default:\n            return a;\n        }\n\n        return '-webkit-' + a + '-ms-' + b + a;\n\n      case 1017:\n        if (-1 === a.indexOf('sticky', 9)) break;\n\n      case 975:\n        c = (a = d).length - 10;\n        b = (33 === a.charCodeAt(c) ? a.substring(0, c) : a).substring(d.indexOf(':', 7) + 1).trim();\n\n        switch (m = b.charCodeAt(0) + (b.charCodeAt(7) | 0)) {\n          case 203:\n            if (111 > b.charCodeAt(8)) break;\n\n          case 115:\n            a = a.replace(b, '-webkit-' + b) + ';' + a;\n            break;\n\n          case 207:\n          case 102:\n            a = a.replace(b, '-webkit-' + (102 < m ? 'inline-' : '') + 'box') + ';' + a.replace(b, '-webkit-' + b) + ';' + a.replace(b, '-ms-' + b + 'box') + ';' + a;\n        }\n\n        return a + ';';\n\n      case 938:\n        if (45 === a.charCodeAt(5)) switch (a.charCodeAt(6)) {\n          case 105:\n            return b = a.replace('-items', ''), '-webkit-' + a + '-webkit-box-' + b + '-ms-flex-' + b + a;\n\n          case 115:\n            return '-webkit-' + a + '-ms-flex-item-' + a.replace(ba, '') + a;\n\n          default:\n            return '-webkit-' + a + '-ms-flex-line-pack' + a.replace('align-content', '').replace(ba, '') + a;\n        }\n        break;\n\n      case 973:\n      case 989:\n        if (45 !== a.charCodeAt(3) || 122 === a.charCodeAt(4)) break;\n\n      case 931:\n      case 953:\n        if (!0 === la.test(d)) return 115 === (b = d.substring(d.indexOf(':') + 1)).charCodeAt(0) ? P(d.replace('stretch', 'fill-available'), c, e, h).replace(':fill-available', ':stretch') : a.replace(b, '-webkit-' + b) + a.replace(b, '-moz-' + b.replace('fill-', '')) + a;\n        break;\n\n      case 962:\n        if (a = '-webkit-' + a + (102 === a.charCodeAt(5) ? '-ms-' + a : '') + a, 211 === e + h && 105 === a.charCodeAt(13) && 0 < a.indexOf('transform', 10)) return a.substring(0, a.indexOf(';', 27) + 1).replace(ma, '$1-webkit-$2') + a;\n    }\n\n    return a;\n  }\n\n  function L(d, c) {\n    var e = d.indexOf(1 === c ? ':' : '{'),\n        h = d.substring(0, 3 !== c ? e : 10);\n    e = d.substring(e + 1, d.length - 1);\n    return R(2 !== c ? h : h.replace(na, '$1'), e, c);\n  }\n\n  function ea(d, c) {\n    var e = P(c, c.charCodeAt(0), c.charCodeAt(1), c.charCodeAt(2));\n    return e !== c + ';' ? e.replace(oa, ' or ($1)').substring(4) : '(' + c + ')';\n  }\n\n  function H(d, c, e, h, a, m, b, v, n, q) {\n    for (var g = 0, x = c, w; g < A; ++g) {\n      switch (w = S[g].call(B, d, x, e, h, a, m, b, v, n, q)) {\n        case void 0:\n        case !1:\n        case !0:\n        case null:\n          break;\n\n        default:\n          x = w;\n      }\n    }\n\n    if (x !== c) return x;\n  }\n\n  function T(d) {\n    switch (d) {\n      case void 0:\n      case null:\n        A = S.length = 0;\n        break;\n\n      default:\n        if ('function' === typeof d) S[A++] = d;else if ('object' === typeof d) for (var c = 0, e = d.length; c < e; ++c) {\n          T(d[c]);\n        } else Y = !!d | 0;\n    }\n\n    return T;\n  }\n\n  function U(d) {\n    d = d.prefix;\n    void 0 !== d && (R = null, d ? 'function' !== typeof d ? w = 1 : (w = 2, R = d) : w = 0);\n    return U;\n  }\n\n  function B(d, c) {\n    var e = d;\n    33 > e.charCodeAt(0) && (e = e.trim());\n    V = e;\n    e = [V];\n\n    if (0 < A) {\n      var h = H(-1, c, e, e, D, z, 0, 0, 0, 0);\n      void 0 !== h && 'string' === typeof h && (c = h);\n    }\n\n    var a = M(O, e, c, 0, 0);\n    0 < A && (h = H(-2, a, e, e, D, z, a.length, 0, 0, 0), void 0 !== h && (a = h));\n    V = '';\n    E = 0;\n    z = D = 1;\n    return a;\n  }\n\n  var ca = /^\\0+/g,\n      N = /[\\0\\r\\f]/g,\n      aa = /: */g,\n      ka = /zoo|gra/,\n      ma = /([,: ])(transform)/g,\n      ia = /,\\r+?/g,\n      F = /([\\t\\r\\n ])*\\f?&/g,\n      fa = /@(k\\w+)\\s*(\\S*)\\s*/,\n      Q = /::(place)/g,\n      ha = /:(read-only)/g,\n      G = /[svh]\\w+-[tblr]{2}/,\n      da = /\\(\\s*(.*)\\s*\\)/g,\n      oa = /([\\s\\S]*?);/g,\n      ba = /-self|flex-/g,\n      na = /[^]*?(:[rp][el]a[\\w-]+)[^]*/,\n      la = /stretch|:\\s*\\w+\\-(?:conte|avail)/,\n      ja = /([^-])(image-set\\()/,\n      z = 1,\n      D = 1,\n      E = 0,\n      w = 1,\n      O = [],\n      S = [],\n      A = 0,\n      R = null,\n      Y = 0,\n      V = '';\n  B.use = T;\n  B.set = U;\n  void 0 !== W && U(W);\n  return B;\n}\n\nexport default stylis_min;\n","var weakMemoize = function weakMemoize(func) {\n  // $FlowFixMe flow doesn't include all non-primitive types as allowed for weakmaps\n  var cache = new WeakMap();\n  return function (arg) {\n    if (cache.has(arg)) {\n      // $FlowFixMe\n      return cache.get(arg);\n    }\n\n    var ret = func(arg);\n    cache.set(arg, ret);\n    return ret;\n  };\n};\n\nexport default weakMemoize;\n","import { StyleSheet } from '@emotion/sheet';\nimport Stylis from '@emotion/stylis';\nimport '@emotion/weak-memoize';\n\n// https://github.com/thysultan/stylis.js/tree/master/plugins/rule-sheet\n// inlined to avoid umd wrapper and peerDep warnings/installing stylis\n// since we use stylis after closure compiler\nvar delimiter = '/*|*/';\nvar needle = delimiter + '}';\n\nfunction toSheet(block) {\n  if (block) {\n    Sheet.current.insert(block + '}');\n  }\n}\n\nvar Sheet = {\n  current: null\n};\nvar ruleSheet = function ruleSheet(context, content, selectors, parents, line, column, length, ns, depth, at) {\n  switch (context) {\n    // property\n    case 1:\n      {\n        switch (content.charCodeAt(0)) {\n          case 64:\n            {\n              // @import\n              Sheet.current.insert(content + ';');\n              return '';\n            }\n          // charcode for l\n\n          case 108:\n            {\n              // charcode for b\n              // this ignores label\n              if (content.charCodeAt(2) === 98) {\n                return '';\n              }\n            }\n        }\n\n        break;\n      }\n    // selector\n\n    case 2:\n      {\n        if (ns === 0) return content + delimiter;\n        break;\n      }\n    // at-rule\n\n    case 3:\n      {\n        switch (ns) {\n          // @font-face, @page\n          case 102:\n          case 112:\n            {\n              Sheet.current.insert(selectors[0] + content);\n              return '';\n            }\n\n          default:\n            {\n              return content + (at === 0 ? delimiter : '');\n            }\n        }\n      }\n\n    case -2:\n      {\n        content.split(needle).forEach(toSheet);\n      }\n  }\n};\n\nvar createCache = function createCache(options) {\n  if (options === undefined) options = {};\n  var key = options.key || 'css';\n  var stylisOptions;\n\n  if (options.prefix !== undefined) {\n    stylisOptions = {\n      prefix: options.prefix\n    };\n  }\n\n  var stylis = new Stylis(stylisOptions);\n\n  if (process.env.NODE_ENV !== 'production') {\n    // $FlowFixMe\n    if (/[^a-z-]/.test(key)) {\n      throw new Error(\"Emotion key must only contain lower case alphabetical characters and - but \\\"\" + key + \"\\\" was passed\");\n    }\n  }\n\n  var inserted = {}; // $FlowFixMe\n\n  var container;\n\n  {\n    container = options.container || document.head;\n    var nodes = document.querySelectorAll(\"style[data-emotion-\" + key + \"]\");\n    Array.prototype.forEach.call(nodes, function (node) {\n      var attrib = node.getAttribute(\"data-emotion-\" + key); // $FlowFixMe\n\n      attrib.split(' ').forEach(function (id) {\n        inserted[id] = true;\n      });\n\n      if (node.parentNode !== container) {\n        container.appendChild(node);\n      }\n    });\n  }\n\n  var _insert;\n\n  {\n    stylis.use(options.stylisPlugins)(ruleSheet);\n\n    _insert = function insert(selector, serialized, sheet, shouldCache) {\n      var name = serialized.name;\n      Sheet.current = sheet;\n\n      if (process.env.NODE_ENV !== 'production' && serialized.map !== undefined) {\n        var map = serialized.map;\n        Sheet.current = {\n          insert: function insert(rule) {\n            sheet.insert(rule + map);\n          }\n        };\n      }\n\n      stylis(selector, serialized.styles);\n\n      if (shouldCache) {\n        cache.inserted[name] = true;\n      }\n    };\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    // https://esbench.com/bench/5bf7371a4cd7e6009ef61d0a\n    var commentStart = /\\/\\*/g;\n    var commentEnd = /\\*\\//g;\n    stylis.use(function (context, content) {\n      switch (context) {\n        case -1:\n          {\n            while (commentStart.test(content)) {\n              commentEnd.lastIndex = commentStart.lastIndex;\n\n              if (commentEnd.test(content)) {\n                commentStart.lastIndex = commentEnd.lastIndex;\n                continue;\n              }\n\n              throw new Error('Your styles have an unterminated comment (\"/*\" without corresponding \"*/\").');\n            }\n\n            commentStart.lastIndex = 0;\n            break;\n          }\n      }\n    });\n    stylis.use(function (context, content, selectors) {\n      switch (context) {\n        case -1:\n          {\n            var flag = 'emotion-disable-server-rendering-unsafe-selector-warning-please-do-not-use-this-the-warning-exists-for-a-reason';\n            var unsafePseudoClasses = content.match(/(:first|:nth|:nth-last)-child/g);\n\n            if (unsafePseudoClasses) {\n              unsafePseudoClasses.forEach(function (unsafePseudoClass) {\n                var ignoreRegExp = new RegExp(unsafePseudoClass + \".*\\\\/\\\\* \" + flag + \" \\\\*\\\\/\");\n                var ignore = ignoreRegExp.test(content);\n\n                if (unsafePseudoClass && !ignore) {\n                  console.error(\"The pseudo class \\\"\" + unsafePseudoClass + \"\\\" is potentially unsafe when doing server-side rendering. Try changing it to \\\"\" + unsafePseudoClass.split('-child')[0] + \"-of-type\\\".\");\n                }\n              });\n            }\n\n            break;\n          }\n      }\n    });\n  }\n\n  var cache = {\n    key: key,\n    sheet: new StyleSheet({\n      key: key,\n      container: container,\n      nonce: options.nonce,\n      speedy: options.speedy\n    }),\n    nonce: options.nonce,\n    inserted: inserted,\n    registered: {},\n    insert: _insert\n  };\n  return cache;\n};\n\nexport default createCache;\n","/* eslint-disable */\n// murmurhash2 via https://github.com/garycourt/murmurhash-js/blob/master/murmurhash2_gc.js\nfunction murmurhash2_32_gc(str) {\n  var l = str.length,\n      h = l ^ l,\n      i = 0,\n      k;\n\n  while (l >= 4) {\n    k = str.charCodeAt(i) & 0xff | (str.charCodeAt(++i) & 0xff) << 8 | (str.charCodeAt(++i) & 0xff) << 16 | (str.charCodeAt(++i) & 0xff) << 24;\n    k = (k & 0xffff) * 0x5bd1e995 + (((k >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n    k ^= k >>> 24;\n    k = (k & 0xffff) * 0x5bd1e995 + (((k >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n    h = (h & 0xffff) * 0x5bd1e995 + (((h >>> 16) * 0x5bd1e995 & 0xffff) << 16) ^ k;\n    l -= 4;\n    ++i;\n  }\n\n  switch (l) {\n    case 3:\n      h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n\n    case 2:\n      h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n\n    case 1:\n      h ^= str.charCodeAt(i) & 0xff;\n      h = (h & 0xffff) * 0x5bd1e995 + (((h >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n  }\n\n  h ^= h >>> 13;\n  h = (h & 0xffff) * 0x5bd1e995 + (((h >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n  h ^= h >>> 15;\n  return (h >>> 0).toString(36);\n}\n\nexport default murmurhash2_32_gc;\n","var unitlessKeys = {\n  animationIterationCount: 1,\n  borderImageOutset: 1,\n  borderImageSlice: 1,\n  borderImageWidth: 1,\n  boxFlex: 1,\n  boxFlexGroup: 1,\n  boxOrdinalGroup: 1,\n  columnCount: 1,\n  columns: 1,\n  flex: 1,\n  flexGrow: 1,\n  flexPositive: 1,\n  flexShrink: 1,\n  flexNegative: 1,\n  flexOrder: 1,\n  gridRow: 1,\n  gridRowEnd: 1,\n  gridRowSpan: 1,\n  gridRowStart: 1,\n  gridColumn: 1,\n  gridColumnEnd: 1,\n  gridColumnSpan: 1,\n  gridColumnStart: 1,\n  msGridRow: 1,\n  msGridRowSpan: 1,\n  msGridColumn: 1,\n  msGridColumnSpan: 1,\n  fontWeight: 1,\n  lineHeight: 1,\n  opacity: 1,\n  order: 1,\n  orphans: 1,\n  tabSize: 1,\n  widows: 1,\n  zIndex: 1,\n  zoom: 1,\n  WebkitLineClamp: 1,\n  // SVG-related properties\n  fillOpacity: 1,\n  floodOpacity: 1,\n  stopOpacity: 1,\n  strokeDasharray: 1,\n  strokeDashoffset: 1,\n  strokeMiterlimit: 1,\n  strokeOpacity: 1,\n  strokeWidth: 1\n};\n\nexport default unitlessKeys;\n","function memoize(fn) {\n  var cache = {};\n  return function (arg) {\n    if (cache[arg] === undefined) cache[arg] = fn(arg);\n    return cache[arg];\n  };\n}\n\nexport default memoize;\n","import hashString from '@emotion/hash';\nimport unitless from '@emotion/unitless';\nimport memoize from '@emotion/memoize';\n\nvar hyphenateRegex = /[A-Z]|^ms/g;\nvar animationRegex = /_EMO_([^_]+?)_([^]*?)_EMO_/g;\nvar processStyleName = memoize(function (styleName) {\n  return styleName.replace(hyphenateRegex, '-$&').toLowerCase();\n});\n\nvar processStyleValue = function processStyleValue(key, value) {\n  if (value == null || typeof value === 'boolean') {\n    return '';\n  }\n\n  switch (key) {\n    case 'animation':\n    case 'animationName':\n      {\n        if (typeof value === 'string') {\n          value = value.replace(animationRegex, function (match, p1, p2) {\n            cursor = {\n              name: p1,\n              styles: p2,\n              next: cursor\n            };\n            return p1;\n          });\n        }\n      }\n  }\n\n  if (unitless[key] !== 1 && key.charCodeAt(1) !== 45 && // custom properties\n  typeof value === 'number' && value !== 0) {\n    return value + 'px';\n  }\n\n  return value;\n};\n\nif (process.env.NODE_ENV !== 'production') {\n  var contentValuePattern = /(attr|calc|counters?|url)\\(/;\n  var contentValues = ['normal', 'none', 'counter', 'open-quote', 'close-quote', 'no-open-quote', 'no-close-quote', 'initial', 'inherit', 'unset'];\n  var oldProcessStyleValue = processStyleValue;\n  var msPattern = /^-ms-/;\n  var hyphenPattern = /-(.)/g;\n  var hyphenatedCache = {};\n\n  processStyleValue = function processStyleValue(key, value) {\n    if (key === 'content') {\n      if (typeof value !== 'string' || contentValues.indexOf(value) === -1 && !contentValuePattern.test(value) && (value.charAt(0) !== value.charAt(value.length - 1) || value.charAt(0) !== '\"' && value.charAt(0) !== \"'\")) {\n        console.error(\"You seem to be using a value for 'content' without quotes, try replacing it with `content: '\\\"\" + value + \"\\\"'`\");\n      }\n    }\n\n    var processed = oldProcessStyleValue(key, value);\n    var isCssVariable = key.charCodeAt(1) === 45;\n\n    if (processed !== '' && !isCssVariable && key.indexOf('-') !== -1 && hyphenatedCache[key] === undefined) {\n      hyphenatedCache[key] = true;\n      console.error(\"Using kebab-case for css properties in objects is not supported. Did you mean \" + key.replace(msPattern, 'ms-').replace(hyphenPattern, function (str, char) {\n        return char.toUpperCase();\n      }) + \"?\");\n    }\n\n    return processed;\n  };\n}\n\nvar shouldWarnAboutInterpolatingClassNameFromCss = true;\n\nfunction handleInterpolation(mergedProps, registered, interpolation, couldBeSelectorInterpolation) {\n  if (interpolation == null) {\n    return '';\n  }\n\n  if (interpolation.__emotion_styles !== undefined) {\n    if (process.env.NODE_ENV !== 'production' && interpolation.toString() === 'NO_COMPONENT_SELECTOR') {\n      throw new Error('Component selectors can only be used in conjunction with babel-plugin-emotion.');\n    }\n\n    return interpolation;\n  }\n\n  switch (typeof interpolation) {\n    case 'boolean':\n      {\n        return '';\n      }\n\n    case 'object':\n      {\n        if (interpolation.anim === 1) {\n          cursor = {\n            name: interpolation.name,\n            styles: interpolation.styles,\n            next: cursor\n          };\n          return interpolation.name;\n        }\n\n        if (interpolation.styles !== undefined) {\n          var next = interpolation.next;\n\n          if (next !== undefined) {\n            // not the most efficient thing ever but this is a pretty rare case\n            // and there will be very few iterations of this generally\n            while (next !== undefined) {\n              cursor = {\n                name: next.name,\n                styles: next.styles,\n                next: cursor\n              };\n              next = next.next;\n            }\n          }\n\n          var styles = interpolation.styles;\n\n          if (process.env.NODE_ENV !== 'production' && interpolation.map !== undefined) {\n            styles += interpolation.map;\n          }\n\n          return styles;\n        }\n\n        return createStringFromObject(mergedProps, registered, interpolation);\n      }\n\n    case 'function':\n      {\n        if (mergedProps !== undefined) {\n          var previousCursor = cursor;\n          var result = interpolation(mergedProps);\n          cursor = previousCursor;\n          return handleInterpolation(mergedProps, registered, result, couldBeSelectorInterpolation);\n        } else if (process.env.NODE_ENV !== 'production') {\n          console.error('Functions that are interpolated in css calls will be stringified.\\n' + 'If you want to have a css call based on props, create a function that returns a css call like this\\n' + 'let dynamicStyle = (props) => css`color: ${props.color}`\\n' + 'It can be called directly with props or interpolated in a styled call like this\\n' + \"let SomeComponent = styled('div')`${dynamicStyle}`\");\n        }\n      }\n    // eslint-disable-next-line no-fallthrough\n\n    default:\n      {\n        if (registered == null) {\n          return interpolation;\n        }\n\n        var cached = registered[interpolation];\n\n        if (process.env.NODE_ENV !== 'production' && couldBeSelectorInterpolation && shouldWarnAboutInterpolatingClassNameFromCss && cached !== undefined) {\n          console.error('Interpolating a className from css`` is not recommended and will cause problems with composition.\\n' + 'Interpolating a className from css`` will be completely unsupported in a future major version of Emotion');\n          shouldWarnAboutInterpolatingClassNameFromCss = false;\n        }\n\n        return cached !== undefined && !couldBeSelectorInterpolation ? cached : interpolation;\n      }\n  }\n}\n\nfunction createStringFromObject(mergedProps, registered, obj) {\n  var string = '';\n\n  if (Array.isArray(obj)) {\n    for (var i = 0; i < obj.length; i++) {\n      string += handleInterpolation(mergedProps, registered, obj[i], false);\n    }\n  } else {\n    for (var _key in obj) {\n      var value = obj[_key];\n\n      if (typeof value !== 'object') {\n        if (registered != null && registered[value] !== undefined) {\n          string += _key + \"{\" + registered[value] + \"}\";\n        } else {\n          string += processStyleName(_key) + \":\" + processStyleValue(_key, value) + \";\";\n        }\n      } else {\n        if (_key === 'NO_COMPONENT_SELECTOR' && process.env.NODE_ENV !== 'production') {\n          throw new Error('Component selectors can only be used in conjunction with babel-plugin-emotion.');\n        }\n\n        if (Array.isArray(value) && typeof value[0] === 'string' && (registered == null || registered[value[0]] === undefined)) {\n          for (var _i = 0; _i < value.length; _i++) {\n            string += processStyleName(_key) + \":\" + processStyleValue(_key, value[_i]) + \";\";\n          }\n        } else {\n          string += _key + \"{\" + handleInterpolation(mergedProps, registered, value, false) + \"}\";\n        }\n      }\n    }\n  }\n\n  return string;\n}\n\nvar labelPattern = /label:\\s*([^\\s;\\n{]+)\\s*;/g;\nvar sourceMapPattern;\n\nif (process.env.NODE_ENV !== 'production') {\n  sourceMapPattern = /\\/\\*#\\ssourceMappingURL=data:application\\/json;\\S+\\s+\\*\\//;\n} // this is the cursor for keyframes\n// keyframes are stored on the SerializedStyles object as a linked list\n\n\nvar cursor;\nvar serializeStyles = function serializeStyles(args, registered, mergedProps) {\n  if (args.length === 1 && typeof args[0] === 'object' && args[0] !== null && args[0].styles !== undefined) {\n    return args[0];\n  }\n\n  var stringMode = true;\n  var styles = '';\n  cursor = undefined;\n  var strings = args[0];\n\n  if (strings == null || strings.raw === undefined) {\n    stringMode = false;\n    styles += handleInterpolation(mergedProps, registered, strings, false);\n  } else {\n    styles += strings[0];\n  } // we start at 1 since we've already handled the first arg\n\n\n  for (var i = 1; i < args.length; i++) {\n    styles += handleInterpolation(mergedProps, registered, args[i], styles.charCodeAt(styles.length - 1) === 46);\n\n    if (stringMode) {\n      styles += strings[i];\n    }\n  }\n\n  var sourceMap;\n\n  if (process.env.NODE_ENV !== 'production') {\n    styles = styles.replace(sourceMapPattern, function (match) {\n      sourceMap = match;\n      return '';\n    });\n  } // using a global regex with .exec is stateful so lastIndex has to be reset each time\n\n\n  labelPattern.lastIndex = 0;\n  var identifierName = '';\n  var match; // https://esbench.com/bench/5b809c2cf2949800a0f61fb5\n\n  while ((match = labelPattern.exec(styles)) !== null) {\n    identifierName += '-' + // $FlowFixMe we know it's not null\n    match[1];\n  }\n\n  var name = hashString(styles) + identifierName;\n\n  if (process.env.NODE_ENV !== 'production') {\n    return {\n      name: name,\n      styles: styles,\n      map: sourceMap,\n      next: cursor\n    };\n  }\n\n  return {\n    name: name,\n    styles: styles,\n    next: cursor\n  };\n};\n\nexport { serializeStyles };\n","var isBrowser = \"object\" !== 'undefined';\nfunction getRegisteredStyles(registered, registeredStyles, classNames) {\n  var rawClassName = '';\n  classNames.split(' ').forEach(function (className) {\n    if (registered[className] !== undefined) {\n      registeredStyles.push(registered[className]);\n    } else {\n      rawClassName += className + \" \";\n    }\n  });\n  return rawClassName;\n}\nvar insertStyles = function insertStyles(cache, serialized, isStringTag) {\n  var className = cache.key + \"-\" + serialized.name;\n\n  if ( // we only need to add the styles to the registered cache if the\n  // class name could be used further down\n  // the tree but if it's a string tag, we know it won't\n  // so we don't have to add it to registered cache.\n  // this improves memory usage since we can avoid storing the whole style string\n  (isStringTag === false || // we need to always store it if we're in compat mode and\n  // in node since emotion-server relies on whether a style is in\n  // the registered cache to know whether a style is global or not\n  // also, note that this check will be dead code eliminated in the browser\n  isBrowser === false && cache.compat !== undefined) && cache.registered[className] === undefined) {\n    cache.registered[className] = serialized.styles;\n  }\n\n  if (cache.inserted[serialized.name] === undefined) {\n    var current = serialized;\n\n    do {\n      var maybeStyles = cache.insert(\".\" + className, current, cache.sheet, true);\n\n      current = current.next;\n    } while (current !== undefined);\n  }\n};\n\nexport { getRegisteredStyles, insertStyles };\n","import createCache from '@emotion/cache';\nimport { serializeStyles } from '@emotion/serialize';\nimport { insertStyles, getRegisteredStyles } from '@emotion/utils';\n\nfunction insertWithoutScoping(cache, serialized) {\n  if (cache.inserted[serialized.name] === undefined) {\n    return cache.insert('', serialized, cache.sheet, true);\n  }\n}\n\nfunction merge(registered, css, className) {\n  var registeredStyles = [];\n  var rawClassName = getRegisteredStyles(registered, registeredStyles, className);\n\n  if (registeredStyles.length < 2) {\n    return className;\n  }\n\n  return rawClassName + css(registeredStyles);\n}\n\nvar createEmotion = function createEmotion(options) {\n  var cache = createCache(options); // $FlowFixMe\n\n  cache.sheet.speedy = function (value) {\n    if (process.env.NODE_ENV !== 'production' && this.ctr !== 0) {\n      throw new Error('speedy must be changed before any rules are inserted');\n    }\n\n    this.isSpeedy = value;\n  };\n\n  cache.compat = true;\n\n  var css = function css() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var serialized = serializeStyles(args, cache.registered, this !== undefined ? this.mergedProps : undefined);\n    insertStyles(cache, serialized, false);\n    return cache.key + \"-\" + serialized.name;\n  };\n\n  var keyframes = function keyframes() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    var serialized = serializeStyles(args, cache.registered);\n    var animation = \"animation-\" + serialized.name;\n    insertWithoutScoping(cache, {\n      name: serialized.name,\n      styles: \"@keyframes \" + animation + \"{\" + serialized.styles + \"}\"\n    });\n    return animation;\n  };\n\n  var injectGlobal = function injectGlobal() {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    var serialized = serializeStyles(args, cache.registered);\n    insertWithoutScoping(cache, serialized);\n  };\n\n  var cx = function cx() {\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    return merge(cache.registered, css, classnames(args));\n  };\n\n  return {\n    css: css,\n    cx: cx,\n    injectGlobal: injectGlobal,\n    keyframes: keyframes,\n    hydrate: function hydrate(ids) {\n      ids.forEach(function (key) {\n        cache.inserted[key] = true;\n      });\n    },\n    flush: function flush() {\n      cache.registered = {};\n      cache.inserted = {};\n      cache.sheet.flush();\n    },\n    // $FlowFixMe\n    sheet: cache.sheet,\n    cache: cache,\n    getRegisteredStyles: getRegisteredStyles.bind(null, cache.registered),\n    merge: merge.bind(null, cache.registered, css)\n  };\n};\n\nvar classnames = function classnames(args) {\n  var cls = '';\n\n  for (var i = 0; i < args.length; i++) {\n    var arg = args[i];\n    if (arg == null) continue;\n    var toAdd = void 0;\n\n    switch (typeof arg) {\n      case 'boolean':\n        break;\n\n      case 'object':\n        {\n          if (Array.isArray(arg)) {\n            toAdd = classnames(arg);\n          } else {\n            toAdd = '';\n\n            for (var k in arg) {\n              if (arg[k] && k) {\n                toAdd && (toAdd += ' ');\n                toAdd += k;\n              }\n            }\n          }\n\n          break;\n        }\n\n      default:\n        {\n          toAdd = arg;\n        }\n    }\n\n    if (toAdd) {\n      cls && (cls += ' ');\n      cls += toAdd;\n    }\n  }\n\n  return cls;\n};\n\nexport default createEmotion;\n","import createEmotion from 'create-emotion';\n\nvar _createEmotion = createEmotion(),\n    flush = _createEmotion.flush,\n    hydrate = _createEmotion.hydrate,\n    cx = _createEmotion.cx,\n    merge = _createEmotion.merge,\n    getRegisteredStyles = _createEmotion.getRegisteredStyles,\n    injectGlobal = _createEmotion.injectGlobal,\n    keyframes = _createEmotion.keyframes,\n    css = _createEmotion.css,\n    sheet = _createEmotion.sheet,\n    cache = _createEmotion.cache;\n\nexport { flush, hydrate, cx, merge, getRegisteredStyles, injectGlobal, keyframes, css, sheet, cache };\n","import { Component, h } from \"preact\";\nimport { css } from \"emotion\";\n\ninterface TraktIconProps {\n  className?: string;\n}\n\nlet className = css`\n  background-image: url(\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMTQ0LjggMTQ0LjgiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDE0NC44IDE0NC44IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgZmlsbD0iI0ZGRkZGRiIgY3g9IjcyLjQiIGN5PSI3Mi40IiByPSI3Mi40Ii8+DQoJPHBhdGggZmlsbD0iI0VEMjIyNCIgZD0iTTI5LjUsMTExLjhjMTAuNiwxMS42LDI1LjksMTguOCw0Mi45LDE4LjhjOC43LDAsMTYuOS0xLjksMjQuMy01LjNMNTYuMyw4NUwyOS41LDExMS44eiIvPg0KCTxwYXRoIGZpbGw9IiNFRDIyMjQiIGQ9Ik01Ni4xLDYwLjZMMjUuNSw5MS4xTDIxLjQsODdsMzIuMi0zMi4yaDBsMzcuNi0zNy42Yy01LjktMi0xMi4yLTMuMS0xOC44LTMuMWMtMzIuMiwwLTU4LjMsMjYuMS01OC4zLDU4LjMNCgkJYzAsMTMuMSw0LjMsMjUuMiwxMS43LDM1bDMwLjUtMzAuNWwyLjEsMmw0My43LDQzLjdjMC45LTAuNSwxLjctMSwyLjUtMS42TDU2LjMsNzIuN0wyNywxMDJsLTQuMS00LjFsMzMuNC0zMy40bDIuMSwybDUxLDUwLjkNCgkJYzAuOC0wLjYsMS41LTEuMywyLjItMS45bC01NS01NUw1Ni4xLDYwLjZ6Ii8+DQoJPHBhdGggZmlsbD0iI0VEMUMyNCIgZD0iTTExNS43LDExMS40YzkuMy0xMC4zLDE1LTI0LDE1LTM5YzAtMjMuNC0xMy44LTQzLjUtMzMuNi01Mi44TDYwLjQsNTYuMkwxMTUuNywxMTEuNHogTTc0LjUsNjYuOGwtNC4xLTQuMQ0KCQlsMjguOS0yOC45bDQuMSw0LjFMNzQuNSw2Ni44eiBNMTAxLjksMjcuMUw2OC42LDYwLjRsLTQuMS00LjFMOTcuOCwyM0wxMDEuOSwyNy4xeiIvPg0KCTxnPg0KCQk8Zz4NCgkJCTxwYXRoIGZpbGw9IiNFRDIyMjQiIGQ9Ik03Mi40LDE0NC44QzMyLjUsMTQ0LjgsMCwxMTIuMywwLDcyLjRDMCwzMi41LDMyLjUsMCw3Mi40LDBzNzIuNCwzMi41LDcyLjQsNzIuNA0KCQkJCUMxNDQuOCwxMTIuMywxMTIuMywxNDQuOCw3Mi40LDE0NC44eiBNNzIuNCw3LjNDMzYuNSw3LjMsNy4zLDM2LjUsNy4zLDcyLjRzMjkuMiw2NS4xLDY1LjEsNjUuMXM2NS4xLTI5LjIsNjUuMS02NS4xDQoJCQkJUzEwOC4zLDcuMyw3Mi40LDcuM3oiLz4NCgkJPC9nPg0KCTwvZz4NCjwvZz4NCjwvc3ZnPg0K\");\n  background-repeat: no-repeat;\n  background-origin: content-box;\n`;\n\nexport default class TraktIcon extends Component<TraktIconProps> {\n  render() {\n    return (\n      <div className={ `${className} ${this.props.className}` } />\n    );\n  }\n}","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","function memoize(fn) {\n  var cache = {};\n  return function (arg) {\n    if (cache[arg] === undefined) cache[arg] = fn(arg);\n    return cache[arg];\n  };\n}\n\nexport default memoize;\n","import memoize from '@emotion/memoize';\n\nvar reactPropsRegex = /^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|default|defer|dir|disabled|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|itemProp|itemScope|itemType|itemID|itemRef|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class)|(on[A-Z].*)|((data|aria|x)-.*))$/i;\nvar index = memoize(reactPropsRegex.test.bind(reactPropsRegex));\n\nexport default index;\n","import PropTypes from 'prop-types';\nimport isPropValid from '@emotion/is-prop-valid';\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nvar channel = '__EMOTION_THEMING__';\n\n// https://github.com/styled-components/styled-components/blob/e05b3fe247e9d956bcde786cec376e32afb85bca/src/utils/create-broadcast.js\n\nvar _contextTypes;\nvar contextTypes = (_contextTypes = {}, _contextTypes[channel] = PropTypes.object, _contextTypes);\n\nfunction setTheme(theme) {\n  this.setState({\n    theme: theme\n  });\n}\nvar testPickPropsOnStringTag = isPropValid;\nvar testPickPropsOnComponent = function testPickPropsOnComponent(key) {\n  return key !== 'theme' && key !== 'innerRef';\n};\nvar testAlwaysTrue = function testAlwaysTrue() {\n  return true;\n};\nvar pickAssign = function pickAssign(testFn, target) {\n  var i = 2;\n  var length = arguments.length;\n\n  for (; i < length; i++) {\n    var source = arguments[i];\n\n    var _key = void 0;\n\n    for (_key in source) {\n      if (testFn(_key)) {\n        target[_key] = source[_key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar warnedAboutExtractStatic = false;\n\nfunction createEmotionStyled(emotion, view) {\n  var _createStyled = function createStyled(tag, options) {\n    if (process.env.NODE_ENV !== 'production') {\n      if (tag === undefined) {\n        throw new Error('You are trying to create a styled element with an undefined component.\\nYou may have forgotten to import it.');\n      }\n    }\n\n    var staticClassName;\n    var identifierName;\n    var stableClassName;\n    var shouldForwardProp;\n\n    if (options !== undefined) {\n      staticClassName = options.e;\n      identifierName = options.label;\n      stableClassName = options.target;\n      shouldForwardProp = tag.__emotion_forwardProp && options.shouldForwardProp ? function (propName) {\n        return tag.__emotion_forwardProp(propName) && // $FlowFixMe\n        options.shouldForwardProp(propName);\n      } : options.shouldForwardProp;\n    }\n\n    var isReal = tag.__emotion_real === tag;\n    var baseTag = staticClassName === undefined ? isReal && tag.__emotion_base || tag : tag;\n\n    if (typeof shouldForwardProp !== 'function') {\n      shouldForwardProp = typeof baseTag === 'string' && baseTag.charAt(0) === baseTag.charAt(0).toLowerCase() ? testPickPropsOnStringTag : testPickPropsOnComponent;\n    }\n\n    return function () {\n      var args = arguments;\n      var styles = isReal && tag.__emotion_styles !== undefined ? tag.__emotion_styles.slice(0) : [];\n\n      if (identifierName !== undefined) {\n        styles.push(\"label:\" + identifierName + \";\");\n      }\n\n      if (staticClassName === undefined) {\n        if (args[0] == null || args[0].raw === undefined) {\n          styles.push.apply(styles, args);\n        } else {\n          styles.push(args[0][0]);\n          var len = args.length;\n          var i = 1;\n\n          for (; i < len; i++) {\n            styles.push(args[i], args[0][i]);\n          }\n        }\n      } else if (process.env.NODE_ENV !== 'production' && !warnedAboutExtractStatic) {\n        console.warn('extractStatic is deprecated and will be removed in emotion@10. We recommend disabling extractStatic or using other libraries like linaria or css-literal-loader');\n        warnedAboutExtractStatic = true;\n      }\n\n      var Styled =\n      /*#__PURE__*/\n      function (_view$Component) {\n        _inheritsLoose(Styled, _view$Component);\n\n        function Styled() {\n          return _view$Component.apply(this, arguments) || this;\n        }\n\n        var _proto = Styled.prototype;\n\n        _proto.componentWillMount = function componentWillMount() {\n          if (this.context[channel] !== undefined) {\n            this.unsubscribe = this.context[channel].subscribe(setTheme.bind(this));\n          }\n        };\n\n        _proto.componentWillUnmount = function componentWillUnmount() {\n          if (this.unsubscribe !== undefined) {\n            this.context[channel].unsubscribe(this.unsubscribe);\n          }\n        };\n\n        _proto.render = function render() {\n          var props = this.props,\n              state = this.state;\n          this.mergedProps = pickAssign(testAlwaysTrue, {}, props, {\n            theme: state !== null && state.theme || props.theme || {}\n          });\n          var className = '';\n          var classInterpolations = [];\n\n          if (props.className) {\n            if (staticClassName === undefined) {\n              className += emotion.getRegisteredStyles(classInterpolations, props.className);\n            } else {\n              className += props.className + \" \";\n            }\n          }\n\n          if (staticClassName === undefined) {\n            className += emotion.css.apply(this, styles.concat(classInterpolations));\n          } else {\n            className += staticClassName;\n          }\n\n          if (stableClassName !== undefined) {\n            className += \" \" + stableClassName;\n          }\n\n          return view.createElement(baseTag, // $FlowFixMe\n          pickAssign(shouldForwardProp, {}, props, {\n            className: className,\n            ref: props.innerRef\n          }));\n        };\n\n        return Styled;\n      }(view.Component);\n\n      Styled.displayName = identifierName !== undefined ? identifierName : \"Styled(\" + (typeof baseTag === 'string' ? baseTag : baseTag.displayName || baseTag.name || 'Component') + \")\";\n\n      if (tag.defaultProps !== undefined) {\n        // $FlowFixMe\n        Styled.defaultProps = tag.defaultProps;\n      }\n\n      Styled.contextTypes = contextTypes;\n      Styled.__emotion_styles = styles;\n      Styled.__emotion_base = baseTag;\n      Styled.__emotion_real = Styled;\n      Styled.__emotion_forwardProp = shouldForwardProp;\n      Object.defineProperty(Styled, 'toString', {\n        value: function value() {\n          if (process.env.NODE_ENV !== 'production' && stableClassName === undefined) {\n            return 'NO_COMPONENT_SELECTOR';\n          } // $FlowFixMe\n\n\n          return \".\" + stableClassName;\n        }\n      });\n\n      Styled.withComponent = function (nextTag, nextOptions) {\n        return _createStyled(nextTag, nextOptions !== undefined ? // $FlowFixMe\n        pickAssign(testAlwaysTrue, {}, options, nextOptions) : options).apply(void 0, styles);\n      };\n\n      return Styled;\n    };\n  };\n\n  if (process.env.NODE_ENV !== 'production' && typeof Proxy !== 'undefined') {\n    _createStyled = new Proxy(_createStyled, {\n      get: function get(target, property) {\n        switch (property) {\n          // react-hot-loader tries to access this stuff\n          case '__proto__':\n          case 'name':\n          case 'prototype':\n          case 'displayName':\n            {\n              return target[property];\n            }\n\n          default:\n            {\n              throw new Error(\"You're trying to use the styled shorthand without babel-plugin-emotion.\" + (\"\\nPlease install and setup babel-plugin-emotion or use the function call syntax(`styled('\" + property + \"')` instead of `styled.\" + property + \"`)\"));\n            }\n        }\n      }\n    });\n  }\n\n  return _createStyled;\n}\n\nexport default createEmotionStyled;\n","import preact from 'preact';\nimport * as emotion from 'emotion';\nexport * from 'emotion';\nimport createEmotionStyled from 'create-emotion-styled';\n\nvar index = createEmotionStyled(emotion, preact);\n\nexport default index;\n","import TraktApi from \"../TraktApi\";\nimport TraktIcon from \"./TraktIcon\";\n\nimport { Component, h } from \"preact\";\nimport { css } from \"emotion\";\nimport styled from \"preact-emotion\";\n\ninterface ConnectButtonProps {\n  api: TraktApi;\n}\n\ninterface ConnectButtonState {\n  isConnected: boolean;\n}\n\nlet className = css`\n  background-color: black;\n  border: 1px solid #222;\n  border-radius: 5px;\n  padding: 2px 7px;\n  color: white;\n  font-size: 11px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n\n  &:hover {\n    background-color: #444;\n  }\n`;\n\nconst Icon = styled(TraktIcon)`\n  height: 14px;\n  width: 14px;\n  margin-right: 5px;\n`;\n\nexport default class ConnectButton extends Component<ConnectButtonProps, ConnectButtonState> {\n  constructor(props: ConnectButtonProps) {\n    super(props);\n    this.state = { isConnected: this.props.api.isAuthenticated() };\n\n    this._handleAuthenticationChanged = this._handleAuthenticationChanged.bind(this);\n    this._handleClick = this._handleClick.bind(this);\n  }\n\n  componentWillMount() {\n    this.props.api.onAuthenticationChanged.sub(this._handleAuthenticationChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.api.onAuthenticationChanged.unsub(this._handleAuthenticationChanged);\n  }\n\n  private _handleAuthenticationChanged() {\n    this.setState({ isConnected: this.props.api.isAuthenticated() });\n  }\n\n  private _handleClick() {\n    let api = this.props.api;\n    if (api.isAuthenticated()) {\n      api.disconnect();\n    } else {\n      api.authenticate();\n    }\n  }\n\n  render() {\n    return (\n      <div className={className} onClick={ this._handleClick }>\n        <Icon />\n        <div class=\"text\">{ this.state.isConnected ? \"Disconnect from Trakt\" : \"Connect with Trakt\" }</div>\n      </div>\n    );\n  }\n}","import TraktScrobble, { TraktScrobbleState } from \"../TraktScrobble\";\nimport { ITraktScrobbleData } from \"../TraktApi\";\n\nimport { Component, h } from \"preact\";\nimport { css } from \"emotion\";\n\ninterface ScrobbleInfoProps {\n  scrobble: TraktScrobble;\n}\n\ninterface ScrobbleInfoState {\n  scrobbleData: ITraktScrobbleData;\n  scrobbleState: TraktScrobbleState;\n  error: string;\n}\n\nconst className = css`\n& .info h2 {\n  font-size: 17px;\n  padding-bottom: 4px;\n}\n`;\n\nexport default class ScrobbleInfo extends Component<ScrobbleInfoProps, ScrobbleInfoState> {\n  constructor(props: ScrobbleInfoProps) {\n    super(props);\n\n    this._onScrobbleStatusChanged = this._onScrobbleStatusChanged.bind(this);\n  }\n\n  componentWillMount() {\n    this.setState({ \n      scrobbleData: this.props.scrobble.data,\n      scrobbleState: this.props.scrobble.state,\n      error: this.props.scrobble.error\n    });\n    this.props.scrobble.onStateChanged.sub(this._onScrobbleStatusChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.scrobble.onStateChanged.unsub(this._onScrobbleStatusChanged);\n  }\n\n  private _onScrobbleStatusChanged(state: TraktScrobbleState) {\n    this.setState({ \n      scrobbleData: this.props.scrobble.data,\n      scrobbleState: this.props.scrobble.state,\n      error: this.props.scrobble.error\n    });\n  }\n\n  render() {\n    let data = this.state.scrobbleData;\n    let info;\n\n    // Still looking up\n    if (this.state.scrobbleState == TraktScrobbleState.Lookup) {\n      info = (\n        <div class=\"lookup\">Loading</div>\n      );\n    \n    // Not found\n    } else if (this.state.scrobbleState == TraktScrobbleState.NotFound) {\n      info = (\n        <div class=\"error\">\n          <h2>Failed to scrobble:</h2>\n          <p>Could not find matching episode on Trakt</p>\n        </div>\n      );\n\n    // Error\n    } else if (this.state.scrobbleState == TraktScrobbleState.Error) {\n      info = (\n        <div class=\"error\">\n          <h2>Failed to scrobble:</h2>\n          <p>{ this.state.error }</p>\n        </div>\n      );\n\n    // Lookup succeeded\n    } else {\n      \n      if (data.movie && data.movie.ids) {\n        let movieUrl = `https://trakt.tv/movies/${data.movie.ids.slug}`;\n        info = (\n          <div class=\"info\">\n            <h2><a href={ movieUrl } target=\"_blank\">{ data.movie.title } ({ data.movie.year })</a></h2>\n          </div>\n        );\n      } else if (data.show && data.show.ids && data.episode && data.episode.ids) {\n        let showUrl = `https://trakt.tv/shows/${data.show.ids.slug}`;\n        let episodeUrl = `${showUrl}/seasons/${data.episode.season}/episodes/${data.episode.number}`;\n        let episodeTitle = data.episode.title ? `: ${data.episode.title}` : null;\n        info = (\n          <div class=\"info\">\n            <h2><a href={ showUrl } target=\"_blank\">{ data.show.title } ({ data.show.year })</a></h2>\n            <p><a href={ episodeUrl } target=\"_blank\">\n              Season { data.episode.season } Episode { data.episode.number }{ episodeTitle }\n            </a></p>\n          </div>\n        );\n      } else {\n        info = (\n          <div class=\"error\">\n            <h2>Internal error:</h2>\n            <p>Missing data</p>\n          </div>\n        );\n      }\n    }\n\n    return (\n      <div className={ className }>\n        { info }\n      </div>\n    );\n  }\n}","import { Component, h } from \"preact\";\nimport { css } from \"emotion\";\n\ninterface ButtonProps {\n  text: string;\n  onClick: JSX.EventHandler<MouseEvent>;\n  className?: string;\n  disabled?: boolean;\n}\n\nconst className = css`\n  font-size: 12px;\n  font-weight: bold;\n  color: #eee;\n  background-color: #333;\n  border: none;\n  border-radius: 3px;\n  margin: 5px;\n  cursor: pointer;\n  padding: 5px 10px 5px 10px;\n  flex-grow: 1;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background-color: #555;\n  }\n`;\n\nexport default class Button extends Component<ButtonProps> {\n  render() {\n    return (\n      <button className={ `${className} ${this.props.className} ${this.props.disabled ? 'disabled' : ''}` } onClick={ this.props.onClick } >\n        { this.props.text }\n      </button>\n    );\n  }\n}","import TraktScrobble, { TraktScrobbleState } from \"../TraktScrobble\";\nimport TraktApi, { ITraktHistoryItem, ITraktScrobbleData } from \"../TraktApi\";\nimport TraktHistory from \"../TraktHistory\";\nimport Button from \"./Button\";\n\nimport { Component, h } from \"preact\";\nimport { css } from \"emotion\";\n\ninterface ScrobbleHistoryProps {\n  scrobbleData: ITraktScrobbleData;\n  history: TraktHistory;\n}\n\ninterface ScrobbleHistoryState {\n  historyItems: ITraktHistoryItem[];\n}\n\nconst className = css`\n  & div {\n    display: flex;\n    justify-content: space-between;\n    border-bottom: 1px solid #666;\n    height: 24px;\n    align-items: flex-end;\n  }\n\n  & button {\n    flex-grow: 0;\n    font-size: 9px;\n    padding: 2px 10px;\n    margin-right: 0;\n    font-weight: normal;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.2s ease;\n  }\n\n  & button:hover {\n    background-color: #eb3b14;\n  }\n\n  & div:hover button {\n    opacity: 1;\n    visibility: visible;\n  }\n`;\n\nconst ActionMap = {\n  scrobble: \"Scrobbled\",\n  checkin: \"Checked in\",\n  watch: \"Watched\"\n};\n\nexport default class ScrobbleHistory extends Component<ScrobbleHistoryProps, ScrobbleHistoryState> {\n  private _traktId: number;\n  private _formatter: Intl.DateTimeFormat;\n\n  constructor(props: ScrobbleHistoryProps) {\n    super(props);\n    this._formatter = new Intl.DateTimeFormat(navigator.language, {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\", \n      hour: \"numeric\", \n      minute: \"numeric\"\n    });\n    this.state = { historyItems: null };\n\n    this._handleHistoryChanged = this._handleHistoryChanged.bind(this);\n  }\n\n  componentWillMount() {\n    let data = this.props.scrobbleData;\n    this._traktId = TraktScrobble.traktIdFromData(data);\n    if (this._traktId !== 0) {\n      let type = TraktScrobble.typeFromData(data);\n      this.props.history.sub(this._traktId, this._handleHistoryChanged);\n      this.props.history.load(type === \"movie\" ? \"movies\" : \"episodes\", this._traktId);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.history.unsub(this._traktId, this._handleHistoryChanged);\n  }\n\n  private _handleHistoryChanged(items: ITraktHistoryItem[]) {\n    this.setState({ historyItems: items });\n  }\n\n  private async _handleRemove(e: MouseEvent, item: ITraktHistoryItem) {\n    let el = e.target as HTMLElement;\n    el.classList.add(\"disabled\");\n    el.innerText = \"Removing...\";\n\n    await this.props.history.remove(item.id);\n\n    el.classList.remove(\"disabled\");\n    el.innerText = \"Remove\";\n  }\n  \n  render() {\n    if (this.state.historyItems && this.state.historyItems.length > 0) {\n      let rows = [];\n      for (let item of this.state.historyItems) {\n        rows.push(\n          <div>\n            <span>{ ActionMap[item.action] } at { this._formatter.format(new Date(item.watched_at)) }</span>\n            <Button text=\"Remove\" onClick={ (e) => this._handleRemove(e, item) } />\n          </div>\n        );\n      }\n      return (\n        <div className={ className }>\n          <h2>Watch History</h2>\n          { rows }\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n}","import TraktRoller from \"../TraktRoller\";\nimport TraktScrobble, { TraktScrobbleState, PlaybackState } from \"../TraktScrobble\";\nimport Button from \"./Button\";\n\nimport { Component, h } from \"preact\";\nimport { css } from \"emotion\";\nimport styled from \"preact-emotion\";\n\ninterface ScrobbleControlProps {\n  roller: TraktRoller;\n  scrobble: TraktScrobble;\n}\n\ninterface ScrobbleControlState {\n  scrobbleState: TraktScrobbleState;\n  scrobblingEnabled: boolean;\n}\n\nconst className = css`\n  display: flex;\n  margin: 5px -5px;\n  justify-content: space-between;\n\n  & > div, & > button {\n    width: 33%;\n  }\n\n  & .state {\n    font-size: 12px;\n    font-weight: bold;\n    text-align: center;\n    color: #fff;\n    background-color: #ed1c24;\n    border: none;\n    border-radius: 3px;\n    margin: 5px;\n    padding: 5px 10px 5px 10px;\n    width: 20%;\n  }\n`;\n\nconst ScrobbleNowButton = styled(Button)`\n  color: #8e44ad;\n  border: 1px solid #8e44ad;\n  background: none;\n\n  &:hover {\n    background-color: #8e44ad;\n    color: #fff;\n  }\n`;\n\nconst EnableScrobbleButton = styled(Button)`\n  color: #16a085;\n  border: 1px solid #16a085;\n  background: none;\n\n  &:hover {\n    background-color: #16a085;\n    color: #fff;\n  }\n`;\n\nconst EnabledStates = [\n  TraktScrobbleState.Found,\n  TraktScrobbleState.Started,\n  TraktScrobbleState.Paused\n];\n\nexport default class ScrobbleControl extends Component<ScrobbleControlProps, ScrobbleControlState> {\n  constructor(props: ScrobbleControlProps) {\n    super(props);\n    this.state = { scrobbleState: this.props.scrobble.state, scrobblingEnabled: this.props.roller.enabled };\n\n    this._onScrobbleStateChanged = this._onScrobbleStateChanged.bind(this);\n    this._onEnabledChanged = this._onEnabledChanged.bind(this);\n    this._handleScrobbleNowClick = this._handleScrobbleNowClick.bind(this);\n    this._handleEnableScrobbleClick = this._handleEnableScrobbleClick.bind(this);\n  }\n\n  componentWillMount() {\n    this.props.scrobble.onStateChanged.sub(this._onScrobbleStateChanged);\n    this.props.roller.onEnabledChanged.sub(this._onEnabledChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.scrobble.onStateChanged.unsub(this._onScrobbleStateChanged);\n    this.props.roller.onEnabledChanged.unsub(this._onEnabledChanged);\n  }\n\n  private _onScrobbleStateChanged(state: TraktScrobbleState) {\n    this.setState({ scrobbleState: state });\n  }\n\n  private _onEnabledChanged(enabled: boolean) {\n    this.setState({ scrobblingEnabled: enabled });\n  }\n\n  private _handleScrobbleNowClick() {\n    this.props.scrobble.scrobbleNow();\n  }\n\n  private _handleEnableScrobbleClick() {\n    this.props.roller.enabled = !this.props.roller.enabled;\n  }\n\n  render() {\n    let state = this.props.scrobble.enabled ? \"Disabled\" : TraktScrobbleState[this.props.scrobble.state];\n    let title = this.props.scrobble.error || \"\";\n\n    let disabled = !(EnabledStates.indexOf(this.state.scrobbleState) >= 0);\n    let label = this.props.roller.enabled ? \"Enable Scrobbling\" : \"Disable Scrobbling\";\n\n    return (\n      <div className={ className }>\n        <div class=\"state\" title={ title }>{ state }</div>\n        <ScrobbleNowButton text=\"Scrobble Now\" onClick={ this._handleScrobbleNowClick } disabled={ disabled } />\n        <EnableScrobbleButton text={ label } onClick={ this._handleEnableScrobbleClick } />\n      </div>\n    );\n  }\n}","import TraktScrobble, { TraktScrobbleState } from \"../TraktScrobble\";\nimport ScrobbleInfo from \"./ScrobbleInfo\";\nimport ScrobbleHistory from \"./ScrobbleHistory\";\nimport { ITraktScrobbleData } from \"../TraktApi\";\nimport TraktHistory from \"../TraktHistory\";\nimport ScrobbleControl from \"./ScrobbleControl\";\nimport TraktRoller from \"../TraktRoller\";\n\nimport { Component, h } from \"preact\";\nimport { css } from \"emotion\";\n\ninterface PopupProps {\n  roller: TraktRoller;\n  scrobble: TraktScrobble;\n  history: TraktHistory;\n}\n\ninterface PopupState {\n  scrobbleData: ITraktScrobbleData;\n}\n\nconst className = css`\n  color: #eee;\n\n  & > div {\n    padding: 15px;\n  }\n\n  & a, & p a {\n    color: #eee;\n    transition: color 0.2s ease;\n  }\n\n  & h2 {\n    font-size: 13px;\n    margin: 0;\n  }\n\n  & h2 a:hover, & p a:hover {\n    color: #ed1c24;\n    text-decoration: none;\n  }\n\n  button.disabled {\n    pointer-events: none;\n    opacity: 0.5;\n  }\n`;\n\nexport default class Popup extends Component<PopupProps, PopupState> {\n  constructor(props: PopupProps) {\n    super(props);\n\n    this._onScrobbleStatusChanged = this._onScrobbleStatusChanged.bind(this);\n  }\n\n  componentWillMount() {\n    this.setState({ scrobbleData: this.props.scrobble.data });\n    this.props.scrobble.onStateChanged.sub(this._onScrobbleStatusChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.scrobble.onStateChanged.unsub(this._onScrobbleStatusChanged);\n  }\n\n  private _onScrobbleStatusChanged(state: TraktScrobbleState) {\n    this.setState({ scrobbleData: this.props.scrobble.data });\n  }\n\n  render() {\n    let scrobble = this.props.scrobble;\n\n    return (\n      <div className={ className }>\n        <ScrobbleInfo scrobble={ this.props.scrobble } />\n        <ScrobbleHistory \n          scrobbleData={ this.state.scrobbleData } \n          history={ this.props.history } \n          key={ TraktScrobble.traktIdFromData(this.state.scrobbleData) }\n        />\n        <ScrobbleControl scrobble={ this.props.scrobble } roller={ this.props.roller } />\n      </div>\n    );\n  }\n}","import TraktRoller from \"../TraktRoller\";\nimport TraktScrobble, { TraktScrobbleState } from \"../TraktScrobble\";\nimport TraktHistory from \"../TraktHistory\";\nimport TraktIcon from \"./TraktIcon\";\nimport Popup from \"./Popup\";\n\nimport { Component, h } from \"preact\";\nimport { css } from \"emotion\";\nimport styled from \"preact-emotion\";\n\ninterface StatusButtonProps {\n  roller: TraktRoller;\n  scrobble: TraktScrobble;\n  history: TraktHistory;\n}\n\ninterface StatusButtonState {\n  scrobbleState: TraktScrobbleState;\n  enabled: boolean;\n}\n\nconst popupClassName = css`\n  background: #161616;\n  border: 1px solid #fff;\n  position: absolute;\n  width: 450px;\n  z-index: 100;\n  left: -209px;\n  border-radius: 4px;\n  transition: all 0.2s ease-in;\n  transition-delay: 0.2s;\n  visibility: hidden;\n  opacity: 0;\n  bottom: 55px;\n\n  &:after, &:before {\n    top: 100%;\n    left: 50%;\n    border: solid transparent;\n    content: \" \";\n    height: 0;\n    width: 0;\n    position: absolute;\n    pointer-events: none;\n  }\n  &:after {\n    border-color: rgba(0, 0, 0, 0);\n    border-top-color: #000000;\n    border-width: 15px;\n    margin-left: -15px;\n  }\n  &:before {\n    border-color: rgba(255, 255, 255, 0);\n    border-top-color: #fff;\n    border-width: 17px;\n    margin-left: -17px;\n  }\n  & .hover-blocker {\n    position: absolute;\n    bottom: -75px;\n    left: 33%;\n    width: 33%;\n    height: 75px;\n  }\n`;\n\nconst className = css`\n  position: relative;\n\n  &:hover .${popupClassName} {\n    visibility: visible;\n    opacity: 1;\n    bottom: 44px;\n  }\n`;\n\nconst buttonClassName = css`\n  width: 38px;\n  height: 24px;\n  background: none;\n  border: none;\n  cursor: pointer;\n  position: relative;\n  z-index: 101;\n\n  &.state-disabled {\n    filter: opacity(0.5);\n  }\n  &.state-scrobbled {\n    filter: hue-rotate(150deg) brightness(1.3);\n  }\n  &.state-error, &.state-notfound {\n    filter: grayscale(1) brightness(2);\n  }\n`;\n\nconst Icon = styled(TraktIcon)`\n  height: 100%;\n`;\n\nexport default class StatusButton extends Component<StatusButtonProps, StatusButtonState> {\n  constructor(props: StatusButtonProps) {\n    super(props);\n    this.state = { scrobbleState: this.props.scrobble.state, enabled: this.props.roller.enabled };\n\n    this._onScrobbleStatusChanged = this._onScrobbleStatusChanged.bind(this);\n    this._onEnabledChanged = this._onEnabledChanged.bind(this);\n    this._handleClick = this._handleClick.bind(this);\n  }\n\n  componentWillMount() {\n    this.props.scrobble.onStateChanged.sub(this._onScrobbleStatusChanged);\n    this.props.roller.onEnabledChanged.sub(this._onEnabledChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.scrobble.onStateChanged.unsub(this._onScrobbleStatusChanged);\n    this.props.roller.onEnabledChanged.unsub(this._onEnabledChanged);\n  }\n\n  private _onScrobbleStatusChanged(state: TraktScrobbleState) {\n    this.setState({ scrobbleState: state });\n  }\n\n  private _onEnabledChanged(enabled: boolean) {\n    this.setState({ enabled: enabled });\n  }\n\n  private _handleClick() {\n    window.open(this.props.scrobble.scrobbleUrl(), '_blank');\n  }\n\n  render() {\n    let state = this.state.enabled ? \"disabled\" : TraktScrobbleState[this.state.scrobbleState].toLowerCase();\n    let stateClass = \"state-\" + state;\n    let title = this.props.scrobble.error || TraktScrobbleState[this.state.scrobbleState];\n    return (\n      <div className={ `${className} right` }>\n        <button className={ `${buttonClassName} ${stateClass}` } title={ title } onClick={ this._handleClick }>\n          <Icon />\n        </button>\n        <div className={ popupClassName }>\n          <Popup roller={ this.props.roller } scrobble={ this.props.scrobble } history={ this.props.history } />\n          <div class=\"hover-blocker\"></div>\n        </div>\n      </div>\n    );\n  }\n}","import TraktApi, { ITraktHistoryItem } from \"./TraktApi\";\n\ninterface History {\n  traktId: number;\n  items: ITraktHistoryItem[] | null, \n  subscribers: Array<(history: ITraktHistoryItem[]) => void>;\n}\n\n/** Load a manage Trakt watched history */\nexport default class TraktHistory {\n  private _api: TraktApi;\n  private _histories: { [key: string]: History } = {};\n\n  constructor(api: TraktApi) {\n    this._api = api;\n  }\n\n  /** Load history for a movie or episode */\n  public async load(type: 'movies' | 'episodes', traktId: number, reload: boolean = false): Promise<ITraktHistoryItem[]> {\n    if (!reload && this._histories[traktId] && this._histories[traktId].items) {\n      return this._histories[traktId].items;\n    }\n\n    let result = await this._api.history(type, traktId);\n    if (TraktApi.isError(result)) {\n      console.error(`TraktRoller: Error loading scrobble history (${result.error})`)\n      return [];\n    }\n\n    this._update(traktId, result);\n    return result;\n  }\n\n  /** Add a new item to the history */\n  public add(traktId: number, item: ITraktHistoryItem) {\n    let history = this._getOrCreateHistory(traktId);\n    if (!history.items) history.items = [];\n    history.items.push(item);\n    history.items.sort((a, b) => new Date(b.watched_at).valueOf() - new Date(a.watched_at).valueOf());\n    this._update(traktId, history.items);\n  }\n\n  /** Remove a watched entry by its id */\n  public async remove(historyId: number): Promise<void> {\n    let result = await this._api.historyRemove(historyId);\n    if (TraktApi.isError(result)) {\n      console.error(`TraktRoller: Error removing scrobble (${result.error})`)\n      return;\n    } else if (result.not_found.ids.indexOf(historyId) >= 0) {\n      console.warn(`TraktRoller: Could not remove history id ${historyId}, not found on server`);\n    }\n\n    outer:\n    for (let traktId of Object.keys(this._histories)) {\n      let history = this._histories[traktId];\n      if (!history.items) continue;\n      for (let i = 0; i < history.items.length; i++) {\n        if (history.items[i].id === historyId) {\n          history.items.splice(i, 1);\n          this._update(history.traktId, history.items);\n          break outer;\n        }\n      }\n    }\n  }\n\n  /** Get notified when the history changes */\n  public sub(traktId: number, callback: (history: ITraktHistoryItem[]) => void) {\n    let history = this._getOrCreateHistory(traktId);\n    history.subscribers.push(callback);\n  }\n\n  /** Remove a history subscriber */\n  public unsub(traktId: number, callback: (history: ITraktHistoryItem[]) => void) {\n    let history = this._histories[traktId];\n    if (!history) return;\n\n    let index = history.subscribers.indexOf(callback);\n    if (index >= 0) history.subscribers.splice(index, 1);\n  }\n\n  private _getOrCreateHistory(traktId: number) {\n    let history = this._histories[traktId];\n    if (!history) {\n      history = this._histories[traktId] = { traktId: traktId, items: null, subscribers: [] };\n    }\n    return history;\n  }\n\n  private _update(traktId: number, items: ITraktHistoryItem[]) {\n    let history = this._getOrCreateHistory(traktId);\n    history.items = items;\n    for (let sub of history.subscribers) { sub(items); }\n  }\n}","import TraktApi, { ITraktScrobbleData, ITraktApiOptions, ITraktScobbleResult, ITraktHistoryItem, IStorage, LocalStorageAdapter } from \"./TraktApi\";\nimport TraktScrobble, { TraktScrobbleState, PlaybackState } from \"./TraktScrobble\";\nimport ConnectButton from \"./ui/ConnectButton\";\nimport StatusButton from \"./ui/StatusButton\";\nimport { SimpleEventDispatcher } from \"ste-simple-events\";\n\nimport { render, h } from 'preact';\nimport TraktHistory from \"./TraktHistory\";\n\ninterface ITraktRollerOptions extends ITraktApiOptions {\n  //\n}\n\nconst EpisodeRegex = /Episode ([\\d\\.]+)/;\nconst SeasonRegex = /Season (\\d+)/;\n\nconst MovieRegexes = [\n  /Movie$/i,\n  /Movie (Dub)$/i,\n  /Movie (Sub)$/i,\n  /Movie (Dubbed)$/i,\n  /Movie (Subtitled)$/i,\n  /^Movie - /i,\n  /The Movie/i,\n];\n\nconst ScrobblingEnabledKey: string = 'TraktRoller.enabled';\n\nexport default class TraktRoller {\n  public onEnabledChanged = new SimpleEventDispatcher<boolean>();\n\n  private _player: playerjs.Player;\n  private _storage: IStorage;\n  private _api: TraktApi;\n  private _scrobble?: TraktScrobble;\n  private _history: TraktHistory;\n  private _enabled: boolean;\n\n  private _duration: number;\n  private _currentTime: number;\n\n  constructor(options: ITraktRollerOptions) {\n    console.log(\"TraktRoller\");\n\n    this._storage = options.storage || new LocalStorageAdapter();\n    this._loadPrefs();\n\n    this._api = new TraktApi(options);\n    this._api.onAuthenticationChanged.sub(this._onAuthenticationChange.bind(this));\n    this._api.loadTokens();\n\n    this._createFooterButton();\n    this._waitForPlayer();\n  }\n\n  public get enabled(): boolean {\n    return this._enabled;\n  }\n\n  public set enabled(value: boolean) {\n    if (this._enabled === value) return;\n    this._enabled = value;\n\n    this._storage.setValue(ScrobblingEnabledKey, value ? \"true\" : \"false\");\n    if (this._scrobble) this._scrobble.enabled = value;\n\n    this.onEnabledChanged.dispatch(value);\n  }\n\n  private async _loadPrefs() {\n    this._enabled = await this._storage.getValue(ScrobblingEnabledKey) === \"true\";\n  }\n\n  private _waitForPlayer() {\n    if (unsafeWindow.VILOS_PLAYERJS) {\n      this._loadPlayer(unsafeWindow.VILOS_PLAYERJS);\n    } else {\n      // Use a setter to wait for the player to be set\n      let value: any;\n      Object.defineProperty(unsafeWindow, \"VILOS_PLAYERJS\", {\n        get: ()=> value,\n        set: (v)=> {\n          value = v;\n          this._loadPlayer(v);\n        }\n      });\n    }\n  }\n\n  private _loadPlayer(player: playerjs.Player) {\n    player.on(playerjs.EVENTS.READY, () => this._playerReady(player));\n  }\n\n  private _playerReady(player: playerjs.Player) {\n    if (!this._api.isAuthenticated()) return;\n\n    let data = this._getScrobbleData();\n    if (!data) return;\n\n    this._player = player;\n    this._player.on(playerjs.EVENTS.TIMEUPDATE,  (info: { seconds: number, duration: number }) => this._onTimeChanged(info));\n    this._player.on(playerjs.EVENTS.PLAY,  () => this._onPlaybackStateChange(PlaybackState.Playing));\n    this._player.on(playerjs.EVENTS.PAUSE, () => this._onPlaybackStateChange(PlaybackState.Paused));\n    this._player.on(playerjs.EVENTS.ENDED, () => this._onPlaybackStateChange(PlaybackState.Ended));\n    this._player.on(playerjs.EVENTS.ERROR, () => this._onPlaybackStateChange(PlaybackState.Ended));\n\n    this._history = new TraktHistory(this._api);\n\n    this._scrobble = new TraktScrobble(this._api, data);\n    this._scrobble.enabled = this.enabled;\n    this._scrobble.onStateChanged.sub(this._onScrobbleStatusChanged.bind(this));\n    this._scrobble.onScrobbled.sub(this._onScrobbled.bind(this));\n\n    this._createStatusButton();\n  }\n\n  private _onTimeChanged(info: { seconds: number, duration: number }) {\n    this._currentTime = info.seconds;\n    this._duration = info.duration;\n    if (this._scrobble) this._scrobble.setPlaybackTime(info.seconds, info.duration);\n  }\n\n  private _onPlaybackStateChange(state: PlaybackState) {\n    if (!this._scrobble) return;\n    this._scrobble.setPlaybackState(state, this._getProgress());\n  }\n\n  private _getProgress(): number {\n    if (!this._duration) {\n      console.warn(`TraktRoller: Duration is not set (${this._duration})`);\n      return 0;\n    } else if (this._duration === undefined) {\n      console.warn(\"TraktRoller: Current time is not set\");\n      return 0;\n    }\n    \n    return this._currentTime / this._duration * 100;\n  }\n\n  private _getScrobbleData(): ITraktScrobbleData |null {\n    let buildDate = new Date(process.env.BUILD_DATE);\n    const data: ITraktScrobbleData = {\n      progress: this._getProgress(),\n      app_version: process.env.VERSION,\n      app_date: `${buildDate.getFullYear()}-${buildDate.getMonth() + 1}-${buildDate.getDate()}`\n    };\n\n    const titleElement = document.querySelector('#showmedia_about_episode_num');\n    if (!titleElement || titleElement.textContent.length == 0) {\n      console.error(\"TraktRoller: Could not find video title\");\n      return null;\n    }\n    let showTitle = titleElement.textContent.trim();\n\n    let episodeTitle: string = undefined;\n    const episodeTitleElement = document.querySelector('#showmedia_about_name');\n    if (episodeTitleElement) {\n      episodeTitle = episodeTitleElement.textContent.trim();\n      if (episodeTitle) {\n        if (episodeTitle.startsWith(\"\")) {\n          episodeTitle = episodeTitle.substring(1);\n        }\n        if (episodeTitle.endsWith(\"\")) {\n          episodeTitle = episodeTitle.substring(0, episodeTitle.length - 1);\n        }\n      }\n    }\n\n    let seasonNumber = 1;\n    let episodeNumber = 0;\n    const episodeElement = document.querySelector('#showmedia_about_media h4:nth-child(2)');\n    if (episodeElement && episodeElement.textContent.length > 0) {\n      const seasonMatch = SeasonRegex.exec(episodeElement.textContent);\n      if (seasonMatch) {\n        seasonNumber = parseInt(seasonMatch[1]);\n      }\n      \n      const episodeMatch = EpisodeRegex.exec(episodeElement.textContent);\n      if (episodeMatch) {\n        episodeNumber = parseFloat(episodeMatch[1]);\n      }\n    }\n\n    if (episodeTitle && MovieRegexes.some(r => r.test(episodeTitle))) {\n      data.movie = {\n        title: showTitle\n      };\n    } else {\n      data.show = {\n        title: showTitle\n      };\n      data.episode = {\n        season: seasonNumber,\n        number: episodeNumber,\n        title: episodeTitle\n      };\n    }\n\n    return data;\n  }\n\n  private _onAuthenticationChange(isAuthenticated: boolean) {\n    if (!isAuthenticated) {\n      this._api.checkAuthenticationResult(window.location.href);\n    }\n  }\n\n  private _onScrobbleStatusChanged(state: TraktScrobbleState) {\n    //\n  }\n\n  private _onScrobbled(result: ITraktScobbleResult) {\n    var item: ITraktHistoryItem = {\n      id: result.id,\n      watched_at: new Date().toISOString(),\n      action: \"scrobble\",\n      type: (result.movie ? 'movie' : 'episode'),\n      movie: result.movie,\n      show: result.show,\n      episode: result.episode\n    };\n    let traktId = result.movie ? result.movie.ids.trakt : result.episode.ids.trakt;\n    this._history.add(traktId, item);\n  }\n\n  private _createFooterButton() {\n    let footer = document.querySelector('#social_media');\n    if (!footer) {\n      console.error(\"TraktRoller: Could not find footer to add trakt connect button\");\n      return;\n    }\n\n    render(\n      <div class=\"footer-column\">\n        <ConnectButton api={ this._api } />\n      </div>,\n      footer\n    );\n  }\n\n  private _createStatusButton() {\n    let container = document.querySelector('.showmedia-submenu');\n    if (!container) {\n      console.error(\"TraktRoller: Could not find share row to add trakt status button\");\n      return;\n    }\n\n    render((\n      <StatusButton roller={ this } scrobble={ this._scrobble } history={ this._history } />\n    ), container);\n  }\n}","import TraktRoller from \"./TraktRoller\";\nimport { GreaseMonkeyStorageAdapter } from \"./TraktApi\";\n\nnew TraktRoller({\n  client_id: \"5ac1bf2ba188fc93f941eb0788ef5cb6e0e4bf96b882e914e6d0c17dacc8e7f2\",\n  client_secret: \"3712241a1c467769e6c03336abb5fb9911f8665354d2aaffaa9f817e147a34ca\",\n  storage: new GreaseMonkeyStorageAdapter()\n});\n"]}